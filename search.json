[{"title":"CSO LUA å‰µç«‹æ•™å­¸","path":"/GFBlog//blog/20240507/CSO-LUA-å‰µç«‹æ•™å­¸/","content":"æ­¥é©Ÿ é¸æ“‡è¦å¥—ç”¨åœ°åœ–ï¼Œåªèƒ½åœ¨ä¸€äººæˆ¿ä½¿ç”¨ã€‚ é€²å…¥éŠæˆ²å¾Œï¼ŒæŒ‰ä¸‹ V + 8ã€‚ é¸æ“‡æ–°å‰µç«‹ä¸¦è¼¸å…¥ä½ çš„è³‡æ–™å¤¾åç¨±ï¼Œåœ¨é»æ“Šç¢ºèªã€‚ è¦–çª—åŒ–çš„æƒ…æ³ä¸‹ï¼Œæœƒè‡ªå‹•åœ¨é›»è…¦ä¸Šæ‰“é–‹è³‡æ–™å¤¾ä½ç½®ã€‚ ç¨‹å¼ç¢¼æ’°å¯«å®Œæˆï¼ŒæŒ‰ä¸‹è®€å–ï¼Œè®€å–æª”æ¡ˆã€‚ æŒ‰ä¸‹æ¸¬è©¦é–‹å§‹å³å¯ã€‚ å·²ç¶“å¾—çŸ¥æª”æ¡ˆè·¯å¾‘ï¼Œä¸¦ä¸”æ’°å¯«å®Œç¨‹å¼ç¢¼ï¼Œå¯ç›´æ¥å¾ç¬¬5é»é–‹å§‹ã€‚ Scriptå ±éŒ¯ç¨‹å¼ç¢¼æœ‰æ’°å¯«éŒ¯èª¤ï¼Œè©³æƒ…è«‹æŸ¥çœ‹éŠæˆ²å…§æ§åˆ¶å°ï¼ŒæŒ‰ä¸‹~å³å¯ã€‚","tags":["CSO LUA","CSO LUAå°æŠ€å·§"],"categories":["CSO LUA"]},{"title":"CSO LUA ç›¸é—œå…§å»ºå‡½å¼èªªæ˜","path":"/GFBlog//blog/20240504/CSO-LUA-ç›¸é—œå…§å»ºå‡½å¼èªªæ˜/","content":"ç›®éŒ„ é—œéµå­— æ•¸å­¸é‹ç®—å­ å­—ä¸²ç›¸æ¥é‹ç®—å­ é‚è¼¯é‹ç®—å­ é—œä¿‚é‹ç®—å­ bitwise ä½å…ƒé‹ç®—å­ Lua Functions é—œéµå­—1234and break do else elseifend false for function ifin local nil not orrepeat return then true until while æ•¸å­¸é‹ç®—å­1+ - * / % ^ 1234561 + 7 -- è¼¸å‡º: 82 - 8 -- è¼¸å‡º: -63 * 9 -- è¼¸å‡º: 274 / 10 -- è¼¸å‡º: 0.45 % 11 -- è¼¸å‡º: 56 ^ 12 -- è¼¸å‡º: 2176782336 å­—ä¸²ç›¸æ¥é‹ç®—å­1.. 1str = &quot;Hello&quot; .. &quot;World&quot; -- str = Hello World é‚è¼¯é‹ç®—å­123and -- ä¸”or -- æˆ–not -- ç›¸å 123456 true and true -- è¼¸å‡º: true true and false -- è¼¸å‡º: false true or true -- è¼¸å‡º: true true or false -- è¼¸å‡º: truefalse or false -- è¼¸å‡º: falsenot true -- è¼¸å‡º: false é—œä¿‚é‹ç®—å­12345678== -- ç›¸ç­‰~= -- ä¸ç›¸ç­‰&gt; -- å¤§æ–¼&lt; -- å°æ–¼&gt;= -- å¤§æ–¼ç­‰æ–¼&lt;= -- å°æ–¼ç­‰æ–¼ 12345678111 == 111 -- è¼¸å‡º: true222 ~= 222 -- è¼¸å‡º: false300 &gt; 400 -- è¼¸å‡º: false300 &lt; 400 -- è¼¸å‡º: true400 &gt;= 400 -- è¼¸å‡º: true400 &gt;= 401 -- è¼¸å‡º: false400 &lt;= 400 -- è¼¸å‡º: true400 &lt;= 399 -- è¼¸å‡º: false bitwise ä½å…ƒé‹ç®—å­1&amp; | ~ &lt;&lt; &gt;&gt; AND 12345673 &amp; 5 -- è¼¸å‡º: 1ç®—æ³•: 00000011 &amp; 00000101------------- 00000001 OR 12345673 | 5 -- è¼¸å‡º: 7ç®—æ³•: 00000011 | 00000101------------- 00000111 XOR 12345673 ~ 5 -- è¼¸å‡º: 6ç®—æ³•: 00000011 ~ 00000101------------- 00000110 Right Shift 123457 &gt;&gt; 1 -- è¼¸å‡º: 3ç®—æ³•:0000 0111 -- åŸæœ¬0000 0011 -- çµæœ Left Shift 123457 &lt;&lt; 1 -- è¼¸å‡º: 14ç®—æ³•:0000 0111 -- åŸæœ¬0000 1110 -- çµæœ NOT 123~7 -- è¼¸å‡º: -8~10 -- è¼¸å‡º: -11~999 -- è¼¸å‡º: -1000 Lua Functionstonumberï¼š è½‰ æ•´æ•¸ è³‡æ–™å‹æ…‹ 12345tonumber(&quot;12as&quot;) -- niltonumber(&quot;12&quot;) -- 12tonumber(123.3) -- 123.3tonumber(1230.0) -- 1230tonumber(1230) -- 1230 tostringï¼š è½‰ å­—ä¸² è³‡æ–™å‹æ…‹ 123tostring(&quot;fafsaf!$&quot;) -- &quot;fafsaf!$&quot;tostring(5606) -- &quot;5606&quot;tostring(125.15665) -- &quot;125.15665&quot; typeï¼š è­˜åˆ¥ è³‡æ–™å‹æ…‹ 12345678a, b, c, d, e, f, g = 1, 2.3, &quot;4&quot;, true, nil, &#123;&#125;, function() endtype(a) -- numbertype(b) -- numbertype(c) -- stringtype(d) -- booleantype(e) -- niltype(f) -- tabletype(g) -- function assertï¼š æª¢æŸ¥ ç•°å¸¸éŒ¯èª¤ï¼Œæœƒå°è‡´ScriptéŒ¯èª¤ 123a, b, c, d, e, f, g = 1, 2.3, &quot;4&quot;, true, nil, &#123;&#125;, function() enda = 1; assert(a == 1) -- è‡ªè¨‚çš„éŒ¯èª¤è¨Šæ¯ï¼Œä¸ä¸€å®šè¦a = 2; assert(a == 1, &quot;è®Šæ•¸aåªèƒ½æ˜¯1&quot;) -- ScriptéŒ¯èª¤ï¼Œæ§åˆ¶å°æœƒæ‹‹å‡ºä½ è‡ªè¨‚çš„éŒ¯èª¤è¨Šæ¯ã€‚ errorï¼š ç•°å¸¸éŒ¯èª¤è¨Šæ¯ï¼Œæœƒå°è‡´ScriptéŒ¯èª¤ 1234pos = &#123;x = 1, y = 1, z = 1&#125;if pos.x == 1 then\terror(&quot;åº§æ¨™XéŒ¯èª¤&quot;)end setmetatableï¼š å…ƒè¡¨ï¼Œé€™æœ‰é»é›£ï¼Œå¯ä»¥åšæˆé¡ä¼¼class 1setmetatable() è©³æƒ… https://www.runoob.com/lua/lua-metatables.html getmetatableï¼š è¿”å›å°åƒå…ƒè¡¨ 1getmetatable() è©³æƒ… https://www.runoob.com/lua/lua-metatables.html printï¼š æ‰“å°ä»»ä½•è³‡æ–™åœ¨æ§åˆ¶å° 1print() logï¼š åœ¨éŠæˆ²è·¯å¾‘&#x2F;bin&#x2F;script.log æ‰“å°ä»»ä½•è³‡æ–™ 1log()","tags":["CSO LUA","CSO LUAå°æŠ€å·§"],"categories":["CSO LUA"]},{"title":"CSO LUA å­¸ç¿’è³‡æº","path":"/GFBlog//blog/20240504/CSO-LUA-å­¸ç¿’è³‡æº/","content":"CSO LUA APIæ–‡æª” å°ç£ç¶²ç«™ è‹±æ–‡ç¶²ç«™ éŸ“åœ‹ç¶²ç«™ LUA å­¸ç¿’ç¶²ç«™ Lua æ•™ç¨‹|èœé³¥æ•™ç¨‹ å€‹äººä½œå“å´©æ½°é‡‘é­šç‡’ ã€DeathRunã€‘æ­»äº¡å¥”è·‘ (éŠæˆ²å…§åœ°åœ–è¤‡è£½ç²å–) ã€LUAè‡ªå–ã€‘ åœ°é€Ÿé¡¯ç¤º (éŠæˆ²å…§åœ°åœ–è¤‡è£½ç²å–) ã€å¿ƒå¾—ã€‘é¡å¤–çš„æ€ªç‰©ä»£ç¢¼å–å¾—æ–¹å¼ (å·´å“ˆå§†ç‰¹) CSO LUA Speedometer (Youtubeã€Github) CSO LUA Chat (Youtubeã€Github) CSO LUA PlayerDirection (Youtubeã€Github) CSO æ­¦å™¨ç¶²ç«™ (é€£çµã€Github) AnggaraNothing(å°å°¼å¤§ç¥) cso-lua-scripting-master (Github) Donxon SDK (Documentã€Github) misk(Ainç¥çš„è¦å¾‹P) ã€æ”»ç•¥ã€‘ä¸æœƒå¯«ç¨‹å¼ä¹Ÿèƒ½æ“æœ‰LuaæŒ‡ä»¤! (éŠæˆ²å…§åœ°åœ–è¤‡è£½ç²å–ã€å·´å“ˆå§†ç‰¹) ã€æ”»ç•¥ã€‘CSO luaé›¶åŸºç¤å°æ•™å®¤ï¼ˆä¸€ï¼‰æ¥è§¸lua (å·´å“ˆå§†ç‰¹) ã€æ”»ç•¥ã€‘CSO luaé›¶åŸºç¤å°æ•™å®¤ï¼ˆäºŒï¼‰å‡½å¼ (å·´å“ˆå§†ç‰¹) ã€æ”»ç•¥ã€‘CSO luaé›¶åŸºç¤å°æ•™å®¤ï¼ˆä¸‰ï¼‰è³‡æ–™å‹æ…‹èˆ‡è¡¨ (å·´å“ˆå§†ç‰¹) ã€æ”»ç•¥ã€‘CSO luaé›¶åŸºç¤å°æ•™å®¤ï¼ˆå››ï¼‰æ·ºè«‡API (å·´å“ˆå§†ç‰¹) ã€æ”»ç•¥ã€‘CSO luaé›¶åŸºç¤å°æ•™å®¤ï¼ˆäº”ï¼‰UIåœ–å‹èˆ‡æ–‡å­—é¡¯ç¤º (å·´å“ˆå§†ç‰¹) ã€æ”»ç•¥ã€‘CSO luaé›¶åŸºç¤å°æ•™å®¤ï¼ˆå…­ï¼‰è£½ä½œäº”å½©ç¹½ç´›çš„æ€ªç‰© (å·´å“ˆå§†ç‰¹) ã€æ”»ç•¥ã€‘Studioæ¨¡å¼ [Lua]CSO API ç¸½æ•™å­¸ (å·´å“ˆå§†ç‰¹) ã€æ”»ç•¥ã€‘Studioæ¨¡å¼ [Lua]CSO API é€²éšæ‡‰ç”¨ (è«‹ç”¨é›»è…¦è§€çœ‹) (å·´å“ˆå§†ç‰¹) ã€æ”»ç•¥ã€‘å¯ä»¥å°è©±çš„æ®­å±NPC (å·´å“ˆå§†ç‰¹) ã€å¿ƒå¾—ã€‘ã€LUAå°æˆæœã€‘è£½ä½œ LUAé‡ç”Ÿæ®­å±ï¼Œæ®­å±ç¾¤é¡åˆ¥ (å·´å“ˆå§†ç‰¹) ã€å¿ƒå¾—ã€‘LUAåœ¨è¢å¹•ä¸Šé¡¯ç¤º ã€åœ“ã€‘ (å·´å“ˆå§†ç‰¹) ã€å¿ƒå¾—ã€‘è‡ªè£½ Lua class : UI.Content åˆ†äº« (è«‹ä½¿ç”¨é›»è…¦è§€çœ‹) (å·´å“ˆå§†ç‰¹) TheM00N(ìµìŠ¤íŠ¸ë¦¼ë²„ë‹ˆí•©) kz amxmodx Lua Script (éŠæˆ²å…§åœ°åœ–è¤‡è£½ç²å–) yutinglia ã€å¿ƒå¾—ã€‘[ Lua ]åƒç´ åœ–é¡¯ç¤º (å·´å“ˆå§†ç‰¹) ruby2009g ã€å¿ƒå¾—ã€‘LUAåœ¨è¢å¹•ä¸Šé¡¯ç¤º ã€ç›´è§’æ¢¯å½¢ã€‘ (å·´å“ˆå§†ç‰¹) ã€å¿ƒå¾—ã€‘[lua]ä»¥æŒ‰éµæ–¹å¼å¦‚ä½•åªåŸ·è¡Œ1æ¬¡ (å·´å“ˆå§†ç‰¹) ã€å¯†æŠ€ã€‘[LUA]é€²å ´15ç§’å…§æœƒä¸€ç›´è‡ªæ®º (å·´å“ˆå§†ç‰¹) ã€å¯†æŠ€ã€‘LUA-é›·é”æ”¹è‰¯ç‰ˆ(å¦‚æœæœ‰äººå†æ¬¡æ”¹è‰¯å¯ä»¥åœ¨ç•™è¨€çµ¦å¤§å®¶ä½¿ç”¨) (å·´å“ˆå§†ç‰¹) LukeTseng1 ã€å¿ƒå¾—ã€‘ã€Luaä»‹é¢UIç´”äº«ã€‘æœ¬äººè£½ä½œçš„ç½å„ä¹‹ç« UIä»‹é¢ å¯ä¾›å¤§çœ¾ä½¿ç”¨ (å·´å“ˆå§†ç‰¹) å†·å‡é­š(Yuugure) ï¼ˆYuugureï¼‰å€åŸŸäº’å‹• LUA (éŠæˆ²å…§åœ°åœ–è¤‡è£½ç²å–ã€å·´å“ˆå§†ç‰¹) ï¼ˆYuugureï¼‰Bossè¡€æ¢ LUA (éŠæˆ²å…§åœ°åœ–è¤‡è£½ç²å–ã€å·´å“ˆå§†ç‰¹) ç«é¾ã€æŸšå­ NPCå°è©±æ¡†åŠŸèƒ½æ¼”ç¤º (éŠæˆ²å…§åœ°åœ–è¤‡è£½ç²å–)","tags":["CSO LUA","CSO LUAå°æŠ€å·§"],"categories":["CSO LUA"]},{"title":"CSO LUA æª”æ¡ˆå»ºç½®èˆ‡é…ç½®","path":"/GFBlog//blog/20240504/CSO-LUA-æª”æ¡ˆå»ºç½®èˆ‡é…ç½®/","content":"ğŸ› ï¸å»ºç½®å»ºè­°ä½¿ç”¨è¦–çª—åŒ–å»ºç«‹ã€‚ åˆæ¬¡ä½¿ç”¨ LUAï¼Œæ‡‰å¾éŠæˆ²å…§é€²è¡Œå‰µå»ºï¼Œå› ç‚ºæª”æ¡ˆä½ç½®å¯èƒ½æœƒè®Šå‹•ï¼Œå°è‡´ç„¡æ³•æ‰¾åˆ°æª”æ¡ˆã€‚ å¦‚æœåœ¨è®€å–æª”æ¡ˆæ™‚æ‰¾ä¸åˆ°æª”æ¡ˆï¼Œå¯èƒ½æ˜¯å› ç‚ºå®˜æ–¹å·²æ›´æ”¹å„²å­˜ä½ç½®ã€‚æ­¤æ™‚ï¼Œåªéœ€æŒ‰ä¸‹ã€Œæ–°å»ºç«‹ã€æŒ‰éˆ•å³å¯ã€‚ å»ºç«‹æ–¹æ³•æœ‰å…©ç¨®ï¼š åœ¨éŠæˆ²å…§æŒ‰ä¸‹ã€Œæ–°å»ºç«‹ã€æŒ‰éˆ•ã€‚ å¦‚æœå·²çŸ¥é“æª”æ¡ˆå„²å­˜è·¯å¾‘ï¼Œå¯ä»¥ç›´æ¥åœ¨ç›¸æ‡‰è³‡æ–™å¤¾å…§å»ºç«‹ã€‚ ğŸ“‘é…ç½®åœ¨è®€å–æª”æ¡ˆæ™‚ï¼Œåªèƒ½è®€å– project.json æª”æ¡ˆã€‚ è®€å–çš„æ–¹å¼å¦‚ä¸‹:ç•¶éŠæˆ²æˆ¿é–“åˆæ¬¡é€£ç·šæ™‚ï¼ŒæœƒåŸ·è¡Œä¸€æ¬¡ game.lua æª”æ¡ˆã€‚ä¹‹å¾Œæ¯ä½ç©å®¶é€£ç·šå¾Œï¼Œéƒ½æœƒåŸ·è¡Œ ui.lua æª”æ¡ˆã€‚æˆ¿é–“å…§æœ‰å¹¾å€‹ç©å®¶å°±æœƒè®€å–å¹¾æ¬¡ ui.lua æª”æ¡ˆã€‚ é è¨­æƒ…æ³ä¸‹ï¼Œé…ç½®å¦‚ä¸‹æ‰€ç¤º 12345678&#123; &quot;game&quot;:[ &quot;game.lua&quot; ], &quot;ui&quot;:[ &quot;ui.lua&quot; ]&#125; è®€å–æª”æ¡ˆçš„é †åºæª”æ¡ˆæœƒæŒ‰ç…§é…ç½®ä¸­çš„é †åºé€²è¡Œè®€å–ã€‚åœ¨ game éƒ¨åˆ†ï¼Œæœƒå…ˆè®€å– common.lua æª”æ¡ˆï¼Œå†è®€å– game.luaï¼›è€Œåœ¨ ui éƒ¨åˆ†ï¼Œå‰‡æœƒå…ˆè®€å– common.lua æª”æ¡ˆï¼Œå†è®€å– ui.luaã€‚ å¾Œé¢è®€å–çš„æª”æ¡ˆä¸­ï¼Œå‰é¢çš„æª”æ¡ˆæ‰€å®šç¾©çš„è®Šæ•¸æ˜¯å¯ä»¥è¢«å¾Œé¢çš„æª”æ¡ˆæ‰€ä½¿ç”¨çš„ã€‚ è‹¥ä½¿ç”¨ local è®Šæ•¸ï¼Œå‰‡åªèƒ½åœ¨ç•¶å‰æª”æ¡ˆä¸­ä½¿ç”¨ï¼Œç„¡æ³•è·¨æª”æ¡ˆä½¿ç”¨ã€‚ 12345678910&#123; &quot;game&quot;:[ &quot;common.lua&quot;, &quot;game.lua&quot; ], &quot;ui&quot;:[ &quot;common.lua&quot;, &quot;ui.lua&quot; ]&#125; ä½¿ç”¨CommonåŠŸèƒ½è‹¥éœ€è¦ä½¿ç”¨ Common åŠŸèƒ½ï¼Œéœ€å¦å¤–æ–°å¢ä¸€å€‹æª”æ¡ˆï¼Œå‘½åç‚º common.luaï¼Œç„¶å¾Œåœ¨ project.json æª”æ¡ˆä¸­é€²è¡Œé…ç½®ã€‚ åªéœ€å»ºç«‹ä¸€å€‹ common.lua æª”æ¡ˆå³å¯ä½¿ç”¨ Common åŠŸèƒ½ï¼Œä½†å‰ææ˜¯è¦åœ¨ game å’Œ ui ä¸­åŒæ™‚è®€å–ã€‚ common.lua çš„åç¨±å¯ä»¥è‡ªè¨‚ï¼Œä¸ä¸€å®šè¦å‘½åç‚º common.luaã€‚ 12345678910&#123; &quot;game&quot;:[ &quot;common.lua&quot;, &quot;game.lua&quot; ], &quot;ui&quot;:[ &quot;common.lua&quot;, &quot;ui.lua&quot; ]&#125; ä¸ç†æƒ³çš„å¯«æ³• ä¸‹æ–¹æƒ³è¦ä½¿ç”¨Commonçš„åŠŸèƒ½ï¼Œä½†è®€å–çš„æª”æ¡ˆå»ä¸ä¸€æ¨£ï¼Œé€™æ¨£çš„è©±common.luaå’Œdata.luaï¼Œéƒ½éœ€è¦å¯«å‡ºç›¸åŒçš„CommonåŠŸèƒ½ï¼Œæ‰èƒ½ä½¿ç”¨ã€‚ å–åŒåç¨±çš„æª”æ¡ˆå¯ä»¥ç¯€çœæª”æ¡ˆä¸¦æ–¹ä¾¿ç®¡ç†ã€‚ 12345678910&#123; &quot;game&quot;:[ &quot;data.lua&quot;, &quot;game.lua&quot; ], &quot;ui&quot;:[ &quot;common.lua&quot;, &quot;ui.lua&quot; ]&#125;","tags":["CSO LUA","CSO LUAå°æŠ€å·§"],"categories":["CSO LUA"]},{"title":"CSO LUA è‡ªè¨‚ç¾©UIç‰©ä»¶","path":"/GFBlog//blog/20240504/CSO-LUA-è‡ªè¨‚ç¾©UIç‰©ä»¶/","content":"ç•¶ä½ æƒ³è¦åœ¨CSO LUAä¸­å»ºç«‹æ›´å¤šå…ƒçš„UIç‰©ä»¶æ™‚ï¼Œå®˜æ–¹åƒ…æä¾›äº†UI.Boxå’ŒUI.Textå…©å€‹é¸é …ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ å¸Œæœ›æœ‰æ›´å¤šè‡ªå®šç¾©çš„UIç‰©ä»¶ï¼Œä½ å¯ä»¥é€éæ‰‹åˆ»Classç‰©ä»¶ä¾†å¯¦ç¾ã€‚é€™æ¨£ä¸€ä¾†ï¼Œä½ å°±èƒ½å¤ æ ¹æ“šè‡ªå·±çš„éœ€æ±‚ä¾†å®¢è£½åŒ–UIç‰©ä»¶äº†ï¼ Lua ä¸­çš„ç‰©ä»¶å°å‘Lua æ˜¯ä¸€ç¨®è¼•é‡ç´šçš„èªè¨€ï¼Œæ²’æœ‰å…§å»ºçš„ class æ¦‚å¿µï¼Œä½†å¯ä»¥é€šéå…¶ä»–æ–¹å¼æ¨¡æ“¬é¡ä¼¼çš„è¡Œç‚ºï¼Œä¾‹å¦‚ä½¿ç”¨è¡¨ï¼ˆtableï¼‰å’Œå…ƒè¡¨ï¼ˆmetatableï¼‰ä¾†å¯¦ç¾å°è±¡å°å‘çš„ç·¨ç¨‹ã€‚å¦‚æœå°æ­¤ä¸å¤ªç†Ÿæ‚‰ï¼Œå¯ä»¥åƒè€ƒä¸€äº›ç·šä¸Šè³‡æºï¼Œæ¯”å¦‚é€™å€‹ç¶²ç«™ã€‚ æ–‡å­—é™°å½± UI ç‰©ä»¶å‡è¨­æˆ‘å€‘è¦å‰µå»ºä¸€å€‹è‡ªå®šç¾©çš„æ–‡å­—é™°å½± UI ç‰©ä»¶ã€‚é¦–å…ˆï¼Œè®“æˆ‘å€‘çœ‹ä¸€ä¸‹å¦‚æœä¸ä½¿ç”¨ class çš„è©±ï¼Œç¨‹å¼ç¢¼æœƒæ˜¯æ€éº¼æ¨£çš„ï¼š 12345678910111213141516171819TextShadow = UI.Text.Create()TextShadow:Set(&#123; text = &quot;å“ˆå›‰&quot;, font = &quot;small&quot;, align = &quot;left&quot;, x = 2, --&lt;&lt; åç§»2é» y = 2, --&lt;&lt; åç§»2é» width = 100, height = 30, r = 255, g = 255, b = 255&#125;)Text = UI.Text.Create()Text:Set(&#123; text = &quot;å“ˆå›‰&quot;, font = &quot;small&quot;, align = &quot;left&quot;, x = 0, y = 0, width = 100, height = 30, r = 255, g = 255, b = 255&#125;) é€™æ¨£çš„ç¨‹å¼ç¢¼çœ‹èµ·ä¾†ç›¸ç•¶å†—é•·ä¸”ä¸æ˜“ç¶­è­·ã€‚ç¾åœ¨ï¼Œè®“æˆ‘å€‘çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ class ä¾†å¯¦ç¾åŒæ¨£çš„åŠŸèƒ½ã€‚ å®šç¾© TextShadow Class TextShadow = &#123;&#125;ï¼šé€™ä¸€è¡Œå‰µå»ºäº†ä¸€å€‹åç‚º TextShadow çš„ç©ºè¡¨ï¼Œç”¨æ–¼å­˜å„²è‡ªå®šç¾©ç‰©ä»¶çš„æ–¹æ³•å’Œå±¬æ€§ã€‚ function TextShadow:Create()ï¼šé€™ä¸€è¡Œå®šç¾©äº†ä¸€å€‹å«åš Create çš„æ–¹æ³•ï¼Œè©²æ–¹æ³•ç”¨æ–¼å‰µå»ºæ–°çš„ TextShadow ç‰©ä»¶ã€‚ä½¿ç”¨ : èªæ³•å®šç¾©çš„æ–¹æ³•éš±å¼åœ°å°‡ç‰©ä»¶è‡ªèº«ä½œç‚ºç¬¬ä¸€å€‹åƒæ•¸ï¼ˆé¡ä¼¼æ–¼å…¶ä»–èªè¨€ä¸­çš„ this æˆ– selfï¼‰ã€‚ åœ¨ Create æ–¹æ³•ä¸­ï¼š é¦–å…ˆï¼Œå‰µå»ºäº†ä¸€å€‹åç‚º newObject çš„æ–°è¡¨ï¼Œç”¨æ–¼å­˜å„² TextShadow ç‰©ä»¶çš„å±¬æ€§å’Œæ–¹æ³•ã€‚ åœ¨ newObject è¡¨ä¸­ï¼Œè¨­ç½®äº†ä¸€å€‹å«åš SetArg çš„è¡¨ï¼Œå…¶ä¸­åŒ…å«äº†ä¸€ç³»åˆ—çš„å±¬æ€§ï¼Œç”¨æ–¼è¨­ç½®é™°å½±æ•ˆæœçš„åƒæ•¸ã€‚é€™äº›åƒæ•¸åŒ…æ‹¬äº†æ–‡æœ¬å…§å®¹ (text)ã€å­—é«” (font)ã€å°é½Šæ–¹å¼ (align)ï¼Œï¼Œä½ç½®(x å’Œ y)ï¼Œå¤§å° (width å’Œ height)ï¼Œé¡è‰² (rã€gã€b å’Œ a) ä»¥åŠåç§»é‡ (offset)ã€‚ æ¥è‘—ï¼Œå‰µå»ºäº†ä¸€å€‹ UI è¡¨ï¼Œå…¶ä¸­åŒ…å«äº†å…©å€‹åç‚º back å’Œ front çš„å±¬æ€§ï¼Œé€™äº›å±¬æ€§åˆ†åˆ¥è¡¨ç¤ºé™°å½±çš„èƒŒæ™¯å’Œå‰æ™¯ï¼Œä¸¦ä¸”ä½¿ç”¨äº† UI.Text.Create() æ–¹æ³•ä¾†å‰µå»ºç›¸æ‡‰çš„æ–‡æœ¬ UI ç‰©ä»¶ã€‚ æœ€å¾Œï¼Œè¨­ç½®äº†ä¸€å€‹åç‚º visible çš„å±¬æ€§ï¼Œè¡¨ç¤ºè©²é™°å½±æ˜¯å¦å¯è¦‹ï¼Œä¸¦å°‡å…¶è¨­ç½®ç‚ºé è¨­å€¼ trueã€‚ ç¸½çš„ä¾†èªªï¼Œé€™æ®µç¨‹å¼ç¢¼å‰µå»ºäº†ä¸€å€‹å…·æœ‰è‡ªå®šç¾©å±¬æ€§å’Œæ–¹æ³•çš„ TextShadow ç‰©ä»¶ï¼Œç”¨æ–¼è¡¨ç¤ºæ–‡æœ¬çš„é™°å½±æ•ˆæœã€‚é€šéé€™ç¨®æ–¹å¼ï¼Œå¯ä»¥æ–¹ä¾¿åœ°å‰µå»ºã€‚ ä¾†è‡ª ChatGPT èªªæ˜ 1234567891011121314151617181920212223242526-- å®šç¾©ç‰©ä»¶TextShadow = &#123;&#125;function TextShadow:Create() -- è‡ªè¨‚ç¾©ç‰©ä»¶å…§å®¹ä¸¦çµ¦é è¨­å€¼ï¼Œå…§å®¹æ€æ¨£éƒ½è¡Œã€‚ local newObject = &#123; SetArg = &#123; text = &quot;&quot;, font = &quot;small&quot;, align = &quot;left&quot;, x = 0, y = 0, width = 0, height = 0, r = 255, g = 255, b = 255, a = 255, offset = 2 &#125;, UI = &#123; back = UI.Text.Create(), front = UI.Text.Create() &#125;, visible = true &#125; return setmetatable(newObject, &#123;__index = TextShadow&#125;)end ä¸Šè¿°ç¨‹å¼ç¢¼å®šç¾©äº†ä¸€å€‹ TextShadow Classï¼Œå…¶ä¸­åŒ…å«äº†ä¸€å€‹ Create æ–¹æ³•ç”¨æ–¼å‰µå»ºæ–°çš„ TextShadow ç‰©ä»¶ã€‚è©²ç‰©ä»¶åŒ…å«äº†ä¸€å€‹ SetArg è¡¨ï¼Œç”¨æ–¼å­˜å„²è¨­å®šåƒæ•¸ï¼Œä¸€å€‹ UI è¡¨ç”¨æ–¼å­˜å„² UI å…ƒä»¶ï¼Œä»¥åŠä¸€å€‹ visible å±¬æ€§ç”¨æ–¼è¡¨ç¤ºé™°å½±æ˜¯å¦å¯è¦‹ã€‚ æ›´æ–° UIæ¥ä¸‹ä¾†æˆ‘å€‘åœ¨å®šç¾©ä¸€å€‹Updateå‡½å¼ï¼Œä¾†æ›´æ–°æˆ‘å€‘çš„UIè¦æ€éº¼è¨­å®šã€‚ function TextShadow:Update()ï¼šé€™ä¸€è¡Œå®šç¾©äº†ä¸€å€‹å«åš Update çš„æ–¹æ³•ï¼Œè©²æ–¹æ³•ç”¨æ–¼æ›´æ–° TextShadow ç‰©ä»¶çš„ UIã€‚ local arg = self.SetArgï¼šé€™ä¸€è¡Œå°‡ self.SetArg è¡¨ç¤ºçš„é™°å½±è¨­ç½®åƒæ•¸å„²å­˜åœ¨æœ¬åœ°è®Šæ•¸ arg ä¸­ï¼Œä»¥ä¾¿æ–¼å¾ŒçºŒä½¿ç”¨ã€‚ local setting = &#123;...&#125;ï¼šé€™ä¸€è¡Œå‰µå»ºäº†ä¸€å€‹åç‚º setting çš„è¡¨ï¼Œå…¶ä¸­åŒ…å«äº†é™°å½±æ•ˆæœçš„è¨­å®šã€‚å°æ–¼æ¯å€‹ UI å…ƒç´ ï¼ˆback å’Œ frontï¼‰ï¼Œè¨­ç½®äº†ç›¸æ‡‰çš„ä½ç½®ï¼ˆx å’Œ yï¼‰ã€é¡è‰²ï¼ˆrã€gã€b å’Œ aï¼‰ç­‰åƒæ•¸ã€‚ for k,v in pairs(self.UI) doï¼šé€™ä¸€è¡Œä½¿ç”¨ pairs å‡½æ•¸éæ­· self.UI è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œå…¶ä¸­ k æ˜¯éµï¼ˆback æˆ– frontï¼‰ï¼Œè€Œ v å‰‡æ˜¯ç›¸æ‡‰çš„å€¼ï¼ˆUI.Text ç‰©ä»¶ï¼‰ã€‚ åœ¨è¿´åœˆä¸­ï¼Œå‰µå»ºäº†ä¸€å€‹åç‚º temp çš„è¡¨ï¼Œç”¨æ–¼å­˜å„²æ›´æ–°å¾Œçš„ UI åƒæ•¸ã€‚é€™äº›åƒæ•¸åŒ…æ‹¬äº†ä½ç½® (x å’Œ y)ï¼Œå¤§å° (width å’Œ height)ï¼Œé¡è‰² (rã€gã€b å’Œ a)ï¼Œä»¥åŠæ–‡æœ¬ç›¸é—œçš„å±¬æ€§ï¼ˆtextã€fontã€alignï¼‰ã€‚ v:Set(temp)ï¼šé€™ä¸€è¡Œèª¿ç”¨äº† UI.Text ç‰©ä»¶çš„ Set æ–¹æ³•ï¼Œä¸¦å°‡æ›´æ–°å¾Œçš„åƒæ•¸ temp å‚³éçµ¦è©²æ–¹æ³•ï¼Œå¾è€Œæ›´æ–°äº† UI çš„å±¬æ€§ã€‚ ç¸½çš„ä¾†èªªï¼Œé€™æ®µç¨‹å¼ç¢¼æ˜¯ç”¨ä¾†æ›´æ–° TextShadow ç‰©ä»¶çš„ UIï¼Œä¸¦æ ¹æ“šè¨­ç½®çš„åƒæ•¸ä¾†æ›´æ–°ç›¸æ‡‰çš„å±¬æ€§ï¼Œä¾‹å¦‚ä½ç½®ã€å¤§å°ã€é¡è‰²ç­‰ã€‚é€™æ¨£ä¸€ä¾†ï¼Œå¯ä»¥åœ¨ç¨‹å¼åŸ·è¡Œéç¨‹ä¸­å‹•æ…‹åœ°æ”¹è®Šé™°å½±æ•ˆæœçš„å¤–è§€ã€‚ ä¾†è‡ª ChatGPT èªªæ˜ 123456789101112131415161718192021222324252627-- æ›´æ–°UIfunction TextShadow:Update() local arg = self.SetArg local setting = &#123; back = &#123;x = arg.offset, y = arg.offset, r = 0, g = 0, b = 0, a = arg.a&#125;, front = &#123;x = 0, y = 0, r = arg.r, g = arg.g, b = arg.b, a = arg.a&#125; &#125; for k,v in pairs(self.UI) do local temp = &#123; text = arg.text, font = arg.font, align = arg.align, x = arg.x + setting[k].x, y = arg.y + setting[k].y, width = arg.width, height = arg.height, r = setting[k].r, g = setting[k].g, b = setting[k].b, a = setting[k].a &#125; v:Set(temp) endend ä¸Šè¿°ç¨‹å¼ç¢¼å®šç¾©äº†ä¸€å€‹ Update æ–¹æ³•ï¼Œç”¨æ–¼æ›´æ–° TextShadow ç‰©ä»¶çš„ UIã€‚è©²æ–¹æ³•æ ¹æ“šè¨­å®šåƒæ•¸æ›´æ–° UI çš„å„å€‹å±¬æ€§ï¼ŒåŒ…æ‹¬ä½ç½®ã€å¤§å°ã€é¡è‰²ç­‰ã€‚ å…¶ä»–å¿…éœ€çš„å‡½å¼ function TextShadow:Set(args)ï¼šé€™ä¸€è¡Œå®šç¾©äº†ä¸€å€‹åç‚º Set çš„æ–¹æ³•ï¼Œè©²æ–¹æ³•ç”¨æ–¼è¨­ç½®é™°å½±æ•ˆæœçš„å±¬æ€§ã€‚é¦–å…ˆï¼Œå®ƒæª¢æŸ¥å‚³å…¥çš„åƒæ•¸æ˜¯å¦ç‚ºä¸€å€‹è¡¨ï¼Œå¦‚æœæ˜¯çš„è©±ï¼Œå‰‡èª¿ç”¨ setArgs å‡½æ•¸å°‡è©²è¡¨ä¸­çš„å€¼è¨­ç½®åˆ° self.SetArg ä¸­ã€‚æœ€å¾Œï¼Œå®ƒèª¿ç”¨äº† self:Update() æ–¹æ³•ä¾†æ›´æ–° UIã€‚ function TextShadow:Get()ï¼šé€™ä¸€è¡Œå®šç¾©äº†ä¸€å€‹åç‚º Get çš„æ–¹æ³•ï¼Œè©²æ–¹æ³•ç”¨æ–¼å–å¾—é™°å½±æ•ˆæœç›®å‰çš„è¨­ç½®å€¼ã€‚å®ƒèª¿ç”¨äº† clone å‡½æ•¸ä¾†è¤‡è£½ self.SetArg è¡¨ï¼Œä»¥é˜²æ­¢ç›´æ¥è¿”å›å¼•ç”¨ã€‚ function TextShadow:Show()ï¼šé€™ä¸€è¡Œå®šç¾©äº†ä¸€å€‹åç‚º Show çš„æ–¹æ³•ï¼Œè©²æ–¹æ³•ç”¨æ–¼é¡¯ç¤ºé™°å½±æ•ˆæœçš„ UIã€‚å®ƒèª¿ç”¨äº† deepCall å‡½æ•¸ä¾†éè¿´åœ°èª¿ç”¨ UI è¡¨ä¸­æ¯å€‹å…ƒç´ çš„ Show æ–¹æ³•ï¼Œä»¥é¡¯ç¤ºç›¸æ‡‰çš„ UIã€‚æœ€å¾Œï¼Œå°‡ self.visible è¨­ç½®ç‚º trueï¼Œè¡¨ç¤ºé™°å½±æ•ˆæœå·²ç¶“é¡¯ç¤ºã€‚ function TextShadow:Hide()ï¼šé€™ä¸€è¡Œå®šç¾©äº†ä¸€å€‹åç‚º Hide çš„æ–¹æ³•ï¼Œè©²æ–¹æ³•ç”¨æ–¼éš±è—é™°å½±æ•ˆæœçš„ UIã€‚å®ƒåŒæ¨£èª¿ç”¨äº† deepCall å‡½æ•¸ä¾†éè¿´åœ°èª¿ç”¨ UI è¡¨ä¸­æ¯å€‹å…ƒç´ çš„ Hide æ–¹æ³•ï¼Œä»¥éš±è—ç›¸æ‡‰çš„ UIã€‚æœ€å¾Œï¼Œå°‡ self.visible è¨­ç½®ç‚º falseï¼Œè¡¨ç¤ºé™°å½±æ•ˆæœå·²ç¶“éš±è—ã€‚ function TextShadow:IsVisible()ï¼šé€™ä¸€è¡Œå®šç¾©äº†ä¸€å€‹åç‚º IsVisible çš„æ–¹æ³•ï¼Œè©²æ–¹æ³•ç”¨æ–¼è¿”å›é™°å½±æ•ˆæœæ˜¯å¦å¯è¦‹çš„ç‹€æ…‹ã€‚å®ƒç°¡å–®åœ°è¿”å› self.visible çš„å€¼ï¼Œä»¥è¡¨ç¤ºé™°å½±æ•ˆæœç›®å‰æ˜¯å¦è™•æ–¼é¡¯ç¤ºç‹€æ…‹ã€‚ ç¸½çš„ä¾†èªªï¼Œé€™äº›æ–¹æ³•ç‚º TextShadow ç‰©ä»¶æä¾›äº†è¨­ç½®ã€å–å¾—ã€é¡¯ç¤ºå’Œéš±è—é™°å½±æ•ˆæœçš„åŠŸèƒ½ï¼Œä¸¦æä¾›äº†ä¸€å€‹æ–¹æ³•ä¾†æŸ¥è©¢é™°å½±æ•ˆæœç›®å‰æ˜¯å¦å¯è¦‹ã€‚ ä¾†è‡ª ChatGPT èªªæ˜ 1234567891011121314151617181920212223242526272829-- è¨­ç½®function TextShadow:Set(args) if type(args) == &quot;table&quot; then setArgs(self.SetArg, args) end self:Update()end-- å–å¾—è¨­å®šå€¼function TextShadow:Get() return clone(self.SetArg)end-- é¡¯ç¤ºfunction TextShadow:Show() deepCall(self.UI, &quot;Show&quot;) self.visible = trueend-- éš±è—function TextShadow:Hide() deepCall(self.UI, &quot;Hide&quot;) self.visible = falseend-- è¿”å›é¡¯ç¤ºç‹€æ…‹function TextShadow:IsVisible() return self.visibleend ä¸Šè¿°ç¨‹å¼ç¢¼å®šç¾©äº†ä¸€äº›å¿…éœ€çš„å‡½å¼ï¼ŒåŒ…æ‹¬è¨­ç½®ã€å–å¾—è¨­å®šå€¼ã€é¡¯ç¤ºã€éš±è—å’Œè¿”å›é¡¯ç¤ºç‹€æ…‹ç­‰åŠŸèƒ½ã€‚é€™äº›å‡½å¼ä½¿å¾— TextShadow ç‰©ä»¶æ›´åŠ æ˜“ç”¨å’Œéˆæ´»ã€‚ è¼”åŠ©å‡½å¼ local function setArgs(data, args)ï¼šé€™æ˜¯ä¸€å€‹å±€éƒ¨å‡½æ•¸ï¼Œç”¨æ–¼æ›´æ–°è¡¨ä¸­çš„å€¼ã€‚å®ƒæ¥å—å…©å€‹åƒæ•¸ï¼Œdata è¡¨ç¤ºå¾…æ›´æ–°çš„è¡¨ï¼Œargs è¡¨ç¤ºåŒ…å«æ–°å€¼çš„è¡¨ã€‚è©²å‡½æ•¸é€šééæ­· data è¡¨ä¸­çš„æ¯å€‹éµï¼Œæª¢æŸ¥æ˜¯å¦å­˜åœ¨ç›¸æ‡‰çš„ args è¡¨ä¸­çš„å€¼ï¼Œå¦‚æœæ˜¯çš„è©±ï¼Œå‰‡å°‡ data è¡¨ä¸­çš„å€¼æ›´æ–°ç‚º args è¡¨ä¸­çš„å°æ‡‰å€¼ã€‚å¦‚æœéµå°æ‡‰çš„å€¼æ˜¯ä¸€å€‹è¡¨ï¼Œå‰‡éè¿´èª¿ç”¨ setArgs å‡½æ•¸ä»¥è™•ç†åµŒå¥—çš„è¡¨ã€‚ local function deepCall(table, funcName, args)ï¼šé€™æ˜¯ä¸€å€‹å±€éƒ¨å‡½æ•¸ï¼Œç”¨æ–¼åœ¨è¡¨ä¸­æ·±å±¤éè¿´åœ°èª¿ç”¨æŒ‡å®šçš„å‡½å¼ã€‚å®ƒæ¥å—ä¸‰å€‹åƒæ•¸ï¼Œtable è¡¨ç¤ºå¾…éæ­·çš„è¡¨ï¼ŒfuncName è¡¨ç¤ºè¦èª¿ç”¨çš„å‡½å¼åç¨±ï¼Œargs è¡¨ç¤ºè¦å‚³éçµ¦è©²å‡½å¼çš„åƒæ•¸ã€‚è©²å‡½æ•¸éæ­· table è¡¨ä¸­çš„æ¯å€‹å…ƒç´ ï¼Œå¦‚æœå…ƒç´ æ˜¯ä¸€å€‹è¡¨ï¼Œå‰‡éè¿´èª¿ç”¨ deepCall å‡½æ•¸ä»¥è™•ç†åµŒå¥—çš„è¡¨ï¼›å¦‚æœå…ƒç´ æ˜¯ä¸€å€‹ userdataï¼Œå‰‡èª¿ç”¨è©² userdata å°è±¡çš„æŒ‡å®šå‡½å¼ï¼Œä¸¦å‚³éåƒæ•¸ argsã€‚ local function clone(table)ï¼šé€™æ˜¯ä¸€å€‹å±€éƒ¨å‡½æ•¸ï¼Œç”¨æ–¼æ·±å±¤è¤‡è£½è¡¨ã€‚å®ƒæ¥å—ä¸€å€‹è¡¨ä½œç‚ºåƒæ•¸ï¼Œä¸¦è¿”å›è©²è¡¨çš„æ·±å±¤è¤‡è£½ã€‚è©²å‡½æ•¸éæ­·åŸå§‹è¡¨ä¸­çš„æ¯å€‹éµå€¼å°ï¼Œå¦‚æœå€¼æ˜¯ä¸€å€‹è¡¨ï¼Œå‰‡éè¿´èª¿ç”¨è‡ªèº«ä»¥è™•ç†åµŒå¥—çš„è¡¨ï¼›å¦å‰‡ï¼Œå°‡éµå€¼å°ç›´æ¥è¤‡è£½åˆ°æ–°çš„è¡¨ä¸­ã€‚ é€™äº›è¼”åŠ©å‡½æ•¸æä¾›äº†å°è¡¨çš„æ“ä½œï¼Œä½¿å¾—ç¨‹å¼ç¢¼æ›´åŠ æ¨¡çµ„åŒ–å’Œæ˜“æ–¼ç†è§£ã€‚é€šéé€™äº›å‡½æ•¸ï¼Œå¯ä»¥æ›´æ–¹ä¾¿åœ°è™•ç†è¤‡é›œçš„æ•¸æ“šçµæ§‹å’ŒåŸ·è¡Œæ·±å±¤éè¿´æ“ä½œã€‚ ä¾†è‡ª ChatGPT èªªæ˜ 123456789101112131415161718192021222324252627282930313233343536-- æ›´æ–°è¨­å®šå€¼local function setArgs(data, args) for k in pairs(data) do if type(data[k]) == type(args[k]) then if type(data[k]) == &quot;table&quot; then setArgs(data[k], args[k]) else data[k] = args[k] end end endend-- æ·±å±¤èª¿ç”¨ï¼Œèª¿ç”¨æŒ‡å®šå‡½å¼local function deepCall(table, funcName, args) for _,v in pairs(table) do if type(v) == &quot;table&quot; then deepCall(v, funcName, args) elseif type(v) == &quot;userdata&quot; then v[funcName](v, args) end endend-- è¤‡è£½è¡¨(table)local function clone(table) local temp = &#123;&#125; for k,v in pairs(table) do if type(v) == &quot;table&quot; then temp[k] = clone(v) else temp[k] = v end end return tempend ä¸Šè¿°ç¨‹å¼ç¢¼å®šç¾©äº†ä¸‰å€‹è¼”åŠ©å‡½å¼ï¼Œåˆ†åˆ¥æ˜¯æ›´æ–°è¨­å®šå€¼çš„ setArgsã€æ·±å±¤èª¿ç”¨çš„ deepCall å’Œè¤‡è£½è¡¨çš„ cloneã€‚é€™äº›å‡½å¼ç”¨æ–¼è™•ç†è¡¨çš„æ“ä½œï¼Œä½¿å¾—ç¨‹å¼ç¢¼æ›´åŠ æ¨¡çµ„åŒ–å’Œæ˜“æ–¼ç†è§£ã€‚ å®Œæ•´ä»£ç¢¼123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140-- æ›´æ–°è¨­å®šå€¼local function setArgs(data, args) for k in pairs(data) do if type(data[k]) == type(args[k]) then if type(data[k]) == &quot;table&quot; then setArgs(data[k], args[k]) else data[k] = args[k] end end endend-- æ·±å±¤èª¿ç”¨ï¼Œèª¿ç”¨æŒ‡å®šå‡½å¼local function deepCall(table, funcName, args) for _,v in pairs(table) do if type(v) == &quot;table&quot; then deepCall(v, funcName, args) elseif type(v) == &quot;userdata&quot; then v[funcName](v, args) end endend-- è¤‡è£½è¡¨(table)local function clone(table) local temp = &#123;&#125; for k,v in pairs(table) do if type(v) == &quot;table&quot; then temp[k] = clone(v) else temp[k] = v end end return tempend-- å®šç¾©ç‰©ä»¶TextShadow = &#123;&#125;function TextShadow:Create() -- è‡ªè¨‚ç¾©ç‰©ä»¶å…§å®¹ä¸¦çµ¦é è¨­å€¼ï¼Œå…§å®¹æ€æ¨£éƒ½è¡Œã€‚ local newObject = &#123; SetArg = &#123; text = &quot;&quot;, font = &quot;small&quot;, align = &quot;left&quot;, x = 0, y = 0, width = 0, height = 0, r = 255, g = 255, b = 255, a = 255, offset = 2 &#125;, UI = &#123; back = UI.Text.Create(), front = UI.Text.Create() &#125;, visible = true &#125; return setmetatable(newObject, &#123;__index = TextShadow&#125;)end-- æ›´æ–°UIfunction TextShadow:Update() local arg = self.SetArg local setting = &#123; back = &#123;x = arg.offset, y = arg.offset, r = 0, g = 0, b = 0, a = arg.a&#125;, front = &#123;x = 0, y = 0, r = arg.r, g = arg.g, b = arg.b, a = arg.a&#125; &#125; for k,v in pairs(self.UI) do local temp = &#123; text = arg.text, font = arg.font, align = arg.align, x = arg.x + setting[k].x, y = arg.y + setting[k].y, width = arg.width, height = arg.height, r = setting[k].r, g = setting[k].g, b = setting[k].b, a = setting[k].a &#125; v:Set(temp) endend-- è¨­ç½®function TextShadow:Set(args) if type(args) == &quot;table&quot; then setArgs(self.SetArg, args) end self:Update()end-- å–å¾—è¨­å®šå€¼function TextShadow:Get() return clone(self.SetArg)end-- é¡¯ç¤ºfunction TextShadow:Show() deepCall(self.UI, &quot;Show&quot;) self.visible = trueend-- éš±è—function TextShadow:Hide() deepCall(self.UI, &quot;Hide&quot;) self.visible = falseend-- è¿”å›é¡¯ç¤ºç‹€æ…‹function TextShadow:IsVisible() return self.visibleend-- æ¸¬è©¦local screen = UI.ScreenSize()local center = &#123;x = screen.width / 2, y = screen.height / 2&#125;text = TextShadow:Create()text:Set(&#123; text = &quot;å“ˆå›‰ ä½ å¥½~&quot;, font = &quot;medium&quot;, align = &quot;center&quot;, x = 0, y = center.y, width = screen.width, height = 50, r = 0, g = 128, b = 255, offset = 5&#125;) ä¸Šè¿°æ˜¯å®Œæ•´çš„ç¨‹å¼ç¢¼ç¯„ä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Class ç‰©ä»¶ä¾†å»ºç«‹è‡ªå®šç¾©çš„æ–‡å­—é™°å½± UI ç‰©ä»¶ã€‚é€™æ¨£çš„è¨­è¨ˆä½¿å¾—ç¨‹å¼ç¢¼æ›´åŠ æ¨¡çµ„åŒ–å’Œæ˜“æ–¼ç†è§£ï¼ŒåŒæ™‚ä¹Ÿæä¾›äº†æ›´å¥½çš„å¯æ“´å±•æ€§å’Œé‡ç”¨æ€§ã€‚","tags":["CSO LUA","CSO LUAå°æŠ€å·§"],"categories":["CSO LUA"]},{"title":"CSO LUA å°æŠ€å·§","path":"/GFBlog//blog/20240504/CSO-LUA-å°æŠ€å·§/","content":"ç©å®¶åº§æ¨™çš„ä½¿ç”¨é€™å¯èƒ½æ˜¯ä½ çš„å¯«æ³•ï¼Œçœ‹èµ·ä¾†æ²’æ¯›ç—…ï¼Œä½†é€™æœƒè®“ç¨‹å¼ç¢¼å¾ˆæ”é•·ã€‚ 123456789x = &#123;&#125;y = &#123;&#125;z = &#123;&#125;function Game.Rule:OnPlayerConnect(player) x[player.index] = player.position.x y[player.index] = player.position.y z[player.index] = player.position.zend é€™æ˜¯æ¯”è¼ƒç†æƒ³çš„å¯«æ³•ï¼Œä¸€å€‹è®Šæ•¸ç›´æ¥å„²å­˜XYZã€‚ 12345playerPosition = &#123;&#125;function Game.Rule:OnPlayerConnect(player) playerPosition[player.index] = player.positionend èˆ‰å€‹ä¾‹å­ï¼Œåƒæ˜¯KZçš„å­˜è®€é»åŠŸèƒ½ã€‚ 123456789101112playerPosition = &#123;&#125;function Game.Rule:OnPlayerSignal(player, signal) if signal == 1 then -- ç•¶ç©å®¶æŒ‰ä¸‹1ï¼Œå„²å­˜åº§æ¨™ playerPosition[player.index] = player.position elseif signal == 2 then -- ç•¶ç©å®¶æŒ‰ä¸‹2ï¼Œè®€å–åº§æ¨™ player.position = playerPosition[player.index] endend å¤§é‡ä¸”é‡è¤‡æ€§é«˜çš„EntityBlockå‰µå»ºé€™æˆ‘å¾ˆå¸¸ç”¨åœ¨KZè£¡é¢çš„è·³æ¿ï¼Œ10å€‹é—œå¡ï¼Œæ¯ä¸€é—œå¯èƒ½æœ‰10å€‹æ¿å­ï¼Œé‚£å°±è¦å‰µå»º100å€‹åº§æ¨™å’Œå‡½å¼ã€‚ 123456789101112131415161718playerPosition = &#123;&#125;block_1 = Game.EntityBlock.Create(&#123;x = 1, y = 1, z = 1&#125;)function block_1:OnTouch(player) playerPosition[player.index] = player.positionendblock_2 = Game.EntityBlock.Create(&#123;x = 2, y = 2, z = 2&#125;)function block_2:OnTouch(player) playerPosition[player.index] = player.positionendblock_3 = Game.EntityBlock.Create(&#123;x = 3, y = 3, z = 3&#125;)function block_3:OnTouch(player) playerPosition[player.index] = player.positionend...ç„¡é™å¾ªç’° åªè¦æŠŠåº§æ¨™å…¨éƒ¨éƒ½å½™æ•´é€²ä¸€å€‹è®Šæ•¸ï¼Œåˆ©ç”¨è¿´åœˆä¾†è·‘å°±ä¸ç”¨å†å¯«ç„¡æ„ç¾©çš„å‡½å¼ã€‚ 123456789101112blocks = &#123; &#123;x = 1, y = 1, z = 1&#125;, &#123;x = 2, y = 2, z = 2&#125;, &#123;x = 3, y = 3, z = 3&#125;&#125;for k,v in pairs(blocks) do local block = Game.EntityBlock.Create(v) function block:OnTouch(player) playerPosition[player.index] = player.position endend å‹•æ…‹ç©å®¶æ’åç³»çµ±ç›´æ¥åˆ©ç”¨Luaå…§å»ºå‡½å¼table.sortå¹«æˆ‘å€‘è™•ç«‹å³å¯ã€‚ 123-- list: æ¬²æ’åºçš„è¡¨(table)-- comp: è‡ªå®šç¾©æ’åºæ–¹å¼(function)table.sort(list [, comp]) 1234567891011121314151617181920playerRank = &#123; &#123;player = player, time = 15&#125;, -- ç©å®¶ä¸€ &#123;player = player, time = 17&#125;, -- ç©å®¶äºŒ &#123;player = player, time = 30&#125;, -- ç©å®¶ä¸‰ &#123;player = player, time = 10&#125;, -- ç©å®¶å›› &#123;player = player, time = 13&#125;, -- ç©å®¶äº”&#125;-- comp: è‡ªè¨‚ç¾©æ’åºï¼Œå°‡è¡¨è£¡é¢çš„timeå±¬æ€§é€²è¡Œæ¯”è¼ƒï¼Œæ™‚é–“å¿«çš„æ’è¶Šå‰é¢ã€‚function sort(a, b) return a.time &lt; b.timeend-- åŸ·è¡Œæ’åºåŠŸèƒ½table.sort(playerRank, sort)--[[çµæœ: playerRank = &#123;ç©å®¶å››, ç©å®¶äº”, ç©å®¶ä¸€, ç©å®¶äºŒ, ç©å®¶ä¸‰&#125;]] å¤šå€‹ç©å®¶çš„SyncValueå„ªåŒ–æƒ³è¦æŠŠGameå¤šå€‹ç©å®¶çš„è³‡æ–™å‚³é€åˆ°UIï¼Œä½ å¯èƒ½æœƒé€™éº¼åšã€‚é€™ä¹Ÿæ²’æ¯›ç—…ï¼Œä½†å¦‚æœå¯«åˆ°24äººï¼Œå¯¦åœ¨æ˜¯å¤ªæ”é•·äº†ã€‚ 12345678910111213141516-- game.luaInitialLevel = 1sync_PlayerLevel_1 = Game.SyncValue.Create(&quot;sync_PlayerLevel.1&quot;)sync_PlayerLevel_2 = Game.SyncValue.Create(&quot;sync_PlayerLevel.2&quot;)sync_PlayerLevel_3 = Game.SyncValue.Create(&quot;sync_PlayerLevel.3&quot;)function Game.Rule:OnPlayerConnect(player) if player.index == 1 then sync_PlayerLevel_1.value = InitialLevel elseif player.index == 2 then sync_PlayerLevel_2.value = InitialLevel elseif player.index == 3 then sync_PlayerLevel_3.value = InitialLevel endend 12345678910111213-- ui.luasync_PlayerLevel_1 = UI.SyncValue.Create(&quot;sync_PlayerLevel.1&quot;)function sync_PlayerLevel_1:OnSync() -- do something endsync_PlayerLevel_2 = UI.SyncValue.Create(&quot;sync_PlayerLevel.2&quot;)function sync_PlayerLevel_2:OnSync() -- do something endsync_PlayerLevel_3 = UI.SyncValue.Create(&quot;sync_PlayerLevel.3&quot;)function sync_PlayerLevel_3:OnSync() -- do something end åªè¦æ”¹æˆé€™æ¨£ï¼Œç¨‹å¼ç¢¼å°±æœƒè®Šå¾—ç°¡æ½”ã€æ˜“æ‡‚ã€‚ 1234567891011-- game.luaInitialLevel = 1sync_PlayerLevel = &#123;&#125;for i = 1, 24 do sync_PlayerLevel[i] = Game.SyncValue.Create(&quot;sync_PlayerLevel.&quot; .. i)endfunction Game.Rule:OnPlayerConnect(player) sync_PlayerLevel[player.index].value = InitialLevelend 12345-- ui.luasync_PlayerLevel = UI.SyncValue.Create(&quot;sync_PlayerLevel.&quot; .. UI.PlayerIndex())function sync_PlayerLevel:OnSync() -- do something end æ•¸å­—è½‰è²¨å¹£æ ¼å¼ ä¾†æº 123456789function comma_value(n) local left,num,right = string.match(n,&#x27;^([^%d]*%d)(%d*)(.-)$&#x27;) return left..(num:reverse():gsub(&#x27;(%d%d%d)&#x27;,&#x27;%1,&#x27;):reverse())..rightendprint(comma_value(10000000)) -- 10,000,000print(comma_value(&quot;10000000&quot;)) -- 10,000,000print(comma_value(123456789)) -- 123,456,789print(comma_value(1234567890)) -- 1,234,567,890 ç§’æ•¸è½‰æ›æ™‚é–“æ ¼å¼é€™å€‹å¯ä»¥è½‰æ›æˆ: å°æ™‚:åˆ†é˜:ç§’ 00:00:00 1234567891011function SecondsToTime(sec) local hour = math.floor(sec / 3600) local minute = math.floor(sec / 60) - (hour * 60) local seconds = math.floor(sec % 60) return string.format(&quot;%02d:%02d:%02d&quot;, hour, minute, seconds)endprint(SecondsToTime(0)) -- 00:00:00print(SecondsToTime(100)) -- 00:01:40print(SecondsToTime(1280)) -- 00:21:20print(SecondsToTime(3600)) -- 01:00:00 é€™å€‹å¯ä»¥è½‰æ›æˆ: åˆ†é˜:ç§’.æ¯«ç§’ 00:00.00 12345678910function SecondsToTime(sec) local minute = math.floor(sec / 60) local seconds = math.floor(sec % 60) return string.format(&quot;%02d:%05.2f&quot;, minute, seconds)endprint(SecondsToTime(0.661)) -- 00:00:00.66print(SecondsToTime(100.185)) -- 00:01:40.19print(SecondsToTime(1280.1698)) -- 00:21:20.17print(SecondsToTime(3600.9541)) -- 01:00:00.95 UIæ¼¸å±¤é¡è‰²1234-- colorA: (table)Aé¡è‰² &#123;r = 255, g = 255, b = 255, a = 255&#125;-- colorB: (table)Bé¡è‰² &#123;r = 255, g = 0, b = 255, a = 255&#125;-- boxCount: (number)ç”¢ç”ŸA~Bä¹‹é–“çš„æ¼¸è®Šé¡è‰²æ•¸é‡GetGradient(colorA, colorB, boxCount) 1234567891011121314151617181920212223function GetGradient(colorA, colorB, boxCount) colorA.a = colorA.a or 255 colorB.a = colorB.a or 255 local temp = &#123;&#125; for i = 1, boxCount do local rAvg = colorA.r + math.floor((colorB.r - colorA.r) * i / boxCount) local gAvg = colorA.g + math.floor((colorB.g - colorA.g) * i / boxCount) local bAvg = colorA.b + math.floor((colorB.b - colorA.b) * i / boxCount) local aAvg = colorA.a + math.floor((colorB.a - colorA.a) * i / boxCount) table.insert(temp, &#123;r = rAvg, g = gAvg, b = bAvg, a = aAvg&#125;) end return tempendprint(GetGradient(&#123;r=255,g=255,b=255&#125;, &#123;r=255,g=0,b=255&#125;, 6))--[[output &#123; &#123;r=255,g=212,b=255&#125;,&#123;r=255,g=170,b=255&#125;,&#123;r=255,g=127,b=255&#125;, &#123;r=255,g= 85,b=255&#125;,&#123;r=255,g= 42,b=255&#125;,&#123;r=255,g= 0,b=255&#125; &#125;]]","tags":["CSO LUA","CSO LUAå°æŠ€å·§"],"categories":["CSO LUA"]},{"title":"about","path":"/GFBlog/about/index.html","content":"123"},{"title":"API æ›´æ–°æ—¥èªŒ","path":"/GFBlog/wiki/csolua/changes.html","content":"1.5 - 2019-11-08 21:27:50T-Scenarioä¸»è¦æ›´æ–° æ·»åŠ  Commonæ¨¡çµ„ï¼Œåœ¨éŠæˆ²å’ŒUIè…³æœ¬ä¸Šé‹è¡Œã€‚ Common.WeaponOption é¡ï¼Œç”¨æ–¼ä¿®æ”¹æ­¦å™¨æ€§èƒ½å’Œçµ±è¨ˆè³‡è¨Šã€‚ Game.Entity è¡ç”ŸéŠæˆ²å¯¦é«”é¡åˆ¥çš„åŸºåº•é¡åˆ¥ã€‚ Game.Monster ç”¨æ–¼è™•ç†æ€ªç‰©å¯¦é«”çš„é¡ï¼Œç¹¼æ‰¿è‡ª Game.Entity åŸºé¡ã€‚ Game.Weapon é¡ï¼Œç”¨æ–¼è™•ç†ç©å®¶æ­¦å™¨å¯¦é«”ã€‚ Game.GetEntity æ–¹æ³•æª¢ç´¢å…·æœ‰çµ¦å®šå¯¦é«”ç´¢å¼•çš„å¯¦é«”å¯¦ä¾‹ã€‚ Game.RandomInt å’Œ Game.RandomFloat æ–¹æ³•ç”¨æ–¼éš¨æ©Ÿæ•¸ç”Ÿæˆå™¨ã€‚ Game.KillAllMonsters æ–¹æ³•ï¼Œæ®ºæ­»æ‰€æœ‰æ€ªç‰©ã€‚ Game.ENTITYTYPEã€Game.MONSTERTYPEã€Game.RENDERFXã€Game.WEAPONCOLOR Game.THIRDPERSON_FIXED_PLANEè¡¨ã€‚ Game.Rule.OnRoundStartFinished äº‹ä»¶ï¼Œåœ¨å›åˆå‡çµæ™‚é–“çµæŸæ™‚èª¿ç”¨ã€‚ Game.Rule.OnPlayerJoiningSpawn äº‹ä»¶ï¼Œåœ¨ç©å®¶é¦–æ¬¡ç”Ÿæˆæ™‚èª¿ç”¨ã€‚ Game.Rule.OnLoadGameSave äº‹ä»¶ï¼Œåœ¨è¼‰å…¥&#x2F;å°å…¥éŠæˆ²ä¿å­˜æ•¸æ“šæ™‚èª¿ç”¨ã€‚ Game.Rule.OnClearGameSave äº‹ä»¶ï¼Œåœ¨æ¸…é™¤éŠæˆ²ä¿å­˜æ•¸æ“šæ™‚èª¿ç”¨ã€‚ Game.Rule.OnTakeDamage äº‹ä»¶ï¼Œåœ¨å¯¦é«”å—åˆ°å‚·å®³æ™‚èª¿ç”¨ã€‚ Game.Rule.OnKilled äº‹ä»¶ï¼Œåœ¨å¯¦é«”è¢«æ®ºæ­»æ™‚èª¿ç”¨ã€‚ Game.Rule.CanBuyWeapon äº‹ä»¶ï¼Œç•¶ç©å®¶å³å°‡åœ¨æ­¦å™¨å•†åº—åŠŸèƒ½è¡¨ä¸­è³¼è²·æ­¦å™¨æ™‚èª¿ç”¨ã€‚ Game.Rule.CanHaveWeaponInHand äº‹ä»¶ï¼Œåœ¨ç©å®¶å³å°‡æ‹¾å–æ­¦å™¨å¯¦é«”æ™‚èª¿ç”¨ã€‚ Game.Rule.OnGetWeapon äº‹ä»¶ï¼Œåœ¨ç©å®¶æ‹¾å–æ­¦å™¨å¯¦é«”æ™‚èª¿ç”¨ã€‚ Game.Rule.OnSwitchWeapon äº‹ä»¶ï¼Œç•¶ç©å®¶å°‡ç•¶å‰æ­¦å™¨åˆ‡æ›åˆ°å¦ä¸€ç¨®æ­¦å™¨æ™‚èª¿ç”¨ã€‚ Game.Rule.PostFireWeapon äº‹ä»¶ï¼Œåœ¨ç©å®¶ç™¼å°„ç•¶å‰æ­¦å™¨æ™‚èª¿ç”¨ã€‚ Game.Rule.OnReload äº‹ä»¶ï¼Œåœ¨ç©å®¶é‡æ–°è¼‰å…¥æ­¦å™¨å½ˆè—¥æ™‚èª¿ç”¨ã€‚ Game.Rule.PostFireWeapon äº‹ä»¶ï¼Œåœ¨ç©å®¶å®Œæˆé‡æ–°è£å¡«æ­¦å™¨å½ˆè—¥æ™‚èª¿ç”¨ã€‚ Game.Player.gravity å­—æ®µï¼Œç”¨æ–¼æ›´æ”¹ç©å®¶çš„é‡åŠ›ã€‚ Game.Player.infiniteclip å­—æ®µï¼Œç”¨æ–¼å•Ÿç”¨&#x2F;ç¦ç”¨ç„¡é™å½ˆè—¥ä¾›æ‡‰ã€‚ ä½¿ç”¨ Game.Player.SetFirstPersonViewã€Game.Player.SetThirdPersonView å’Œ Game.Player.SetThirdPersonFixedView æ–¹æ³•æ›´æ”¹ç©å®¶çš„æ”åƒæ©Ÿé€è¦–åœ–ã€‚ Game.Player.SetThirdPersonFixedPlane æ–¹æ³•ï¼Œç”¨æ–¼åœ¨ä½¿ç”¨å›ºå®šçš„ç¬¬ä¸‰äººç¨±æ”åƒæ©Ÿæ™‚æ›´æ”¹æ»‘é¼ æŒ‡æ¨™å…‰ç·šæŠ•å°„ã€‚ æ–°çš„æ­¦å™¨åº«å­˜ç³»çµ±ï¼Œå¯ä»¥ä¿å­˜éŠæˆ²ï¼Œå¼•å…¥Game.Player.GetWeaponInvenListï¼ŒGame.Player.SetWeaponInvenLockedUIï¼ŒGame.Player.ShowWeaponInvenï¼ŒGame.Player.ToggleWeaponInvenå’ŒGame.Player.ClearWeaponInvenæ–¹æ³•ã€‚ ä½¿ç”¨ Game.Player.GetPrimaryWeapon å’Œ Game.Player.GetSecondaryWeapon æ–¹æ³•æª¢ç´¢ç©å®¶çš„ç•¶å‰æ­¦å™¨ã€‚ ä½¿ç”¨ Game.Player.SetBuymenuLockedUI æ–¹æ³•å•Ÿå‹•æ®­å±å ´æ™¯æ¨£å¼çš„ UIã€‚ Game.Player.SetBuymenuLockedUI æ–¹æ³•è‡ªå®šç¾©æ­¦å™¨è³¼ç‰©åŠŸèƒ½è¡¨å¤–è§€ã€‚ ä½¿ç”¨ Game.Player.Signal æ–¹æ³•å’Œ UI å¾ä¼ºæœå™¨ç™¼é€ UI ä¿¡è™Ÿã€‚Event.OnSignal äº‹ä»¶ã€‚ æ–°çš„éµè¼¸å…¥äº‹ä»¶ï¼ŒUIã€‚Event.OnKeyDown å’Œ UIã€‚Event.OnKeyUpã€‚ æ”¹è®Š ç”±æ–¼æ–°æ·»åŠ äº† Game.Entity åŸºé¡ï¼ŒGame.Player çš„æŸäº›æ¬„ä½å°‡ç§»å‹•åˆ°è©²åŸºé¡ï¼Œä¸¦å¾è©²åŸºé¡ç¹¼æ‰¿ã€‚ 1.4å¯¦ç¾äº†éŠæˆ²ä¿å­˜ APIã€‚ æ·»åŠ  Game.Rule.CanSave æ–¹æ³•ï¼Œç”¨æ–¼æª¢æŸ¥ç•¶å‰åœ°åœ–æ˜¯å¦æ”¯æŒéŠæˆ²ä¿å­˜ã€‚ ä½¿ç”¨ Game.Rule.SetGameSave å’Œ Game.Rule.GetGameSave æ–¹æ³•è¼‰å…¥å’Œä¿å­˜å…±äº«éŠæˆ²ä¿å­˜æ•¸æ“šã€‚ ä½¿ç”¨ Game.Player.SetGameSave å’Œ Game.Player.GetGameSave æ–¹æ³•è¼‰å…¥å’Œä¿å­˜ç©å®¶çš„éŠæˆ²ä¿å­˜æ•¸æ“šã€‚ ä½¿ç”¨ Game.Rule.OnReceiveGameSave äº‹ä»¶æ›æ¥éŠæˆ²ä¿å­˜è¼‰å…¥äº‹ä»¶ã€‚ ä½¿ç”¨ Game.Rule.OnGameSave äº‹ä»¶æ›æ¥éŠæˆ²ä¿å­˜äº‹ä»¶ã€‚ 1.3æ·»åŠ  å°‡ aksha æ®­å±æ¨¡å‹æ·»åŠ åˆ° Game.MODEL è¡¨ ï¼ˆGame.MODEL.AKSHA_ZOMBIE &amp; Game.MODEL.AKSHA_ZOMBIE_HOSTï¼‰ ä¸­ã€‚ å›ºå®š ä¿®å¾©äº†UIä¸­çš„æ‹¼å¯«éŒ¯èª¤ã€‚SyncValue.valueã€‚ 1.2æ·»åŠ  ä½¿ç”¨ Game.Rule.OnRoundStart å’Œ UI æŒ‚é‰¤æ–°ä¸€è¼ªé–‹å§‹çš„äº‹ä»¶ã€‚Event.OnRoundStart äº‹ä»¶ã€‚ å›ºå®š ä¿®å¾©äº†æ›´æ”¹ Game.Player.team å­—æ®µä¸¦èª¿ç”¨ Game.Player.Win æ–¹æ³•å¾Œï¼Œè…³æœ¬åœ¨ä¸‹ä¸€è¼ªé–‹å§‹æ™‚é‡æ–°å•Ÿå‹•çš„å•é¡Œã€‚ 1.1 æ·»åŠ  Game.SetTrigger æ–¹æ³•ï¼Œç”¨æ–¼ï¼ˆå–æ¶ˆï¼‰å•Ÿå‹•â€œè¨­å‚™æ§åˆ¶è…³æœ¬â€å¡Šã€‚ Game.GetTriggerEntity å’Œ Game.GetScriptCallerï¼Œç”¨æ–¼â€œFunction Callerâ€å¡Šèª¿ç”¨çš„å…¨åŸŸå‡½æ•¸ã€‚ Game.WEAPONTYPEå’ŒGame.HITBOXè¡¨ã€‚ é€šé Game.Player.team æ¬„ä½æ›´æ”¹ç©å®¶çš„åœ˜éšŠã€‚ é€šé Game.Player.flinch æ¬„ä½æ›´æ”¹ç©å®¶å—åˆ°å‚·å®³æ™‚çš„å‰›åº¦ã€‚ é€šé Game.Player.knockback å­—æ®µæ›´æ”¹ç©å®¶å—åˆ°å‚·å®³æ™‚çš„æ“Šé€€ã€‚ é€šé Game.Player.model æ¬„ä½æ›´æ”¹ç©å®¶çš„æ¨¡å‹ã€‚ ä½¿ç”¨ Game.Rule.OnPlayerAttack äº‹ä»¶æŒ‚é‰¤ç©å®¶çš„æ‰¿å—å‚·å®³äº‹ä»¶ã€‚ ä½¿ç”¨UIåœ¨UIè…³æœ¬ä¸­æª¢ç´¢ç©å®¶çš„å¯¦é«”ç´¢å¼•ã€‚PlayerIndex æ–¹æ³•ã€‚ é€šéUIæª¢ç´¢UIç‰©ä»¶çš„é…ç½®ã€‚Box.Get å’Œ UIã€‚Text.Get æ–¹æ³•ã€‚ ä½¿ç”¨ Game.GetTime å’Œ UI æª¢ç´¢å¼•æ“æ™‚é–“ã€‚GetTime æ–¹æ³•ã€‚ Function Callerå¡Šï¼Œç”¨æ–¼èª¿ç”¨åœ¨éŠæˆ²è…³æœ¬ä¸­è²æ˜çš„å…¨åŸŸå‡½æ•¸ã€‚ æ”¹è®Š åœ¨ Game.Rule.OnPlayerKilled äº‹ä»¶ä¸Šæ·»åŠ äº†â€œweapontypeâ€å’Œâ€œhitboxâ€åƒæ•¸ã€‚ åœ¨Game.Rule.Winå’ŒGame.Player.Winæ–¹æ³•ä¸Šæ·»åŠ äº†â€œexitâ€åƒæ•¸ï¼Œä»¥åœ¨ä¸‹ä¸€è¼ªé–‹å§‹æ™‚çµ‚æ­¢éŠæˆ²ã€‚ å›ºå®š ç©å®¶å¯ä»¥åœ¨ Game.Rule.OnPlayerKilled äº‹ä»¶ä¸­ä½¿ç”¨ Game.Player.Respawn æ–¹æ³•ä»¥ç¨‹å¼è¨­è¨ˆæ–¹å¼æ­£ç¢ºé‡ç”Ÿã€‚ 1.0 é¦–æ¬¡ç™¼ä½ˆã€‚"},{"title":"GameSave API","path":"/GFBlog/wiki/csolua/gamesave.html","content":"å•Ÿç”¨éŠæˆ²ä¿å­˜åŠŸèƒ½é€šéåˆ†é…åœ°åœ–çš„ gamesave çµ„ç´¢å¼•ï¼Œå¯ä»¥ä½¿ç”¨ GameSave åŠŸèƒ½ä¾†æ”¯æ´åœ°åœ–ã€‚è¦ç¦ç”¨å®ƒï¼Œåªéœ€å–æ¶ˆåˆ†é…å…¶éŠæˆ²ä¿å­˜çµ„ç´¢å¼•å³å¯ã€‚ éŠæˆ²ä¿å­˜æ•¸æ“šéŠæˆ²å„²å­˜è³‡æ–™æœ‰ 2 ç¨®é¡å‹ï¼š å…±ç”¨éŠæˆ²ä¿å­˜æ•¸æ“šã€‚ ç©å®¶éŠæˆ²ä¿å­˜æ•¸æ“šã€‚ å…±ç”¨çš„éŠæˆ²å­˜æª”æ•¸æ“šå°‡å…±ç”¨åˆ°åŒä¸€å­˜æª”éŠæˆ²çµ„ç´¢å¼•ä¸Šçš„æ‰€æœ‰åœ°åœ–ã€‚ ä¾‹å¦‚ï¼Œå°‡æ˜ å°„Aå’Œæ˜ å°„Båˆ†é…çµ¦ä¿å­˜éŠæˆ²çµ„ç´¢å¼•1ã€‚ç„¶å¾Œï¼Œè…³æœ¬ç·¨å¯«å™¨ä½¿ç”¨ Game.Rule.SetGameSave ä¿å­˜åœ°åœ–Aä¸Šçš„è³‡æ–™ã€‚ä¹‹å¾Œï¼Œä¿å­˜çš„æ•¸æ“šå°‡å…±ç”¨åˆ°å…©å€‹åœ°åœ–ï¼Œä¸¦å¯ä»¥ä½¿ç”¨ Game.Rule.GetGameSave é€²è¡Œæª¢ç´¢ã€‚ åŒæ™‚åœ¨ç©å®¶éŠæˆ²ä¿å­˜æ•¸æ“šæ™‚ï¼Œæœƒä¿å­˜åœ¨ç‰¹å®šç©å®¶èº«ä¸Šï¼Œå…±ç”¨åˆ°åŒä¸€ä¿å­˜éŠæˆ²çµ„ç´¢å¼•ä¸Šçš„æ‰€æœ‰åœ°åœ–ã€‚ ä¾‹å¦‚ï¼Œå°‡æ˜ å°„Aå’Œæ˜ å°„Båˆ†é…çµ¦ä¿å­˜éŠæˆ²çµ„ç´¢å¼•1ã€‚ç„¶å¾Œï¼Œç©å®¶Bobæ’­æ”¾åœ°åœ–Aä¸¦ä½¿ç”¨ Game.Player.SetGameSave ä¿å­˜æ•¸æ“šã€‚é€€å‡ºåœ°åœ–Aå¾Œï¼Œç©å®¶â€Bobâ€æ’­æ”¾åœ°åœ–Bã€‚ç„¶å¾Œï¼Œä¿å­˜çš„æ•¸æ“šå°‡å…±ç”¨åˆ°å…©å€‹åœ°åœ–ï¼Œä¸¦å¯ä»¥ä½¿ç”¨ç©å®¶Bobçš„Game.Player.GetGameSaveé€²è¡Œæª¢ç´¢ã€‚ ä¿å­˜ä¸¦è¼‰å…¥å…±ç”¨çš„éŠæˆ²ä¿å­˜æ•¸æ“šæœƒåœ¨éŠæˆ²é–‹å§‹æ™‚è‡ªå‹•è¼‰å…¥ï¼Œä¸¦åœ¨éŠæˆ²çµæŸæ™‚æ¯ 1 åˆ†é˜æˆ–çµæŸæ™‚è‡ªå‹•æ‰¹é‡ä¿å­˜ã€‚ ç©å®¶éŠæˆ²ä¿å­˜æ•¸æ“šå¯ä»¥è‡ªå‹•è¼‰å…¥ï¼Œä¹Ÿå¯ä»¥åœ¨é¦–æ¬¡ç”Ÿæˆå¾ŒæŒ‰Læ‰‹å‹•è¼‰å…¥ï¼Œå…·é«”å–æ±ºæ–¼ Common.SetAutoLoad è¨­ç½®ã€‚ å¦‚æœç©å®¶æ²’æœ‰è¼‰å…¥æ•¸æ“šï¼Œå®ƒå°‡æ¯ 1 åˆ†é˜æˆ–åœ¨éŠæˆ²çµæŸæ™‚è‡ªå‹•ä¿å­˜ä¸¦è¢«æ–°è³‡æ–™è¦†è“‹ï¼ æ™®é€šç©å®¶éŠæˆ²ä¿å­˜æ•¸æ“šç©å®¶æ•¸æ“šæœƒè‡ªå‹•ä¿å­˜å’Œè¼‰å…¥ä¸€äº›å¸¸ç”¨æ•¸æ“šä»¥ä¸‹æ˜¯å®ƒå€‘æ¸…å–®ï¼š healthmaxhealtharmormaxarmorcoinitems ç›®å‰è¡€é‡è¡€é‡æœ€å¤§å€¼ç›®å‰è­·ç”²è­·ç”²æœ€å¤§å€¼Studio é‡‘å¹£æ•¸é‡Studio ç‰©å“èƒŒåŒ…æ¸…å–® ç”±æ–¼ä¸Šè¿°æ•¸æ“šæ˜¯è‡ªå‹•ä¿å­˜çš„ï¼Œå› æ­¤è…³æœ¬ç·¨å¯«å™¨ç„¡æ³•ä½¿ç”¨ Game.Player.SetGameSave æ–¹æ³•è¦†è“‹å®ƒå€‘ã€‚ä½†æ˜¯ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Game.Player.GetGameSave æ–¹æ³•æª¢ç´¢å®ƒå€‘ã€‚"},{"path":"/GFBlog/wiki/csolua/index.html","content":"Modules æ¨¡çµ„ Common è©²æ¨¡çµ„åŒ…å«ç”¨æ–¼åœ¨å®¢æˆ¶ç«¯å’Œä¼ºæœå™¨ä¸Šä¸€èµ·é‹è¡Œçš„è…³æœ¬çš„åŠŸèƒ½ã€‚ æ‡‰è©²å®‰è£åœ¨ã€Œ project.json ã€çš„gameå’Œuié™£åˆ—ä¸­ã€‚ Game æ­¤æ¨¡çµ„åŒ…å«åƒ…åœ¨ä¼ºæœå™¨ä¸Šé‹è¡Œçš„è…³æœ¬çš„åŠŸèƒ½ã€‚ æ‡‰å®‰è£åœ¨ã€Œproject.jsonã€çš„gameé™£åˆ—ä¸­ã€‚ UI æ­¤æ¨¡çµ„åŒ…å«åƒ…åœ¨ç”¨æˆ¶ç«¯ä¸Šé‹è¡Œçš„è…³æœ¬çš„åŠŸèƒ½ã€‚ æ‡‰å®‰è£åœ¨ã€Œproject.jsonã€çš„uié™£åˆ—ä¸­ã€‚ Classes é¡åˆ¥Common Common.WeaponOption é€šç”¨æ­¦å™¨é¸é …é¡ã€‚ é€™å°‡å½±éŸ¿æ‰€æœ‰å…·æœ‰çµ¦å®šæ­¦å™¨IDçš„ç”Ÿæˆæ­¦å™¨ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨ä¿®æ”¹äº† AK-47 çš„ WeaponOptionï¼ŒéŠæˆ²ä¸­ä½¿ç”¨çš„æ‰€æœ‰ AK-47 éƒ½å°‡åæ˜ ä¿®æ”¹å¾Œçš„çµ±è¨ˆæ•¸æ“šã€‚ Game Game.EntityGame.EntityBlockGame.RuleGame.MonsterGame.PlayerGame.SyncValueGame.Weapon éŠæˆ²å¯¦é«”çš„åŸºç¤é¡Studio è£ç½®æ–¹å¡Šé¡éŠæˆ²è¦å‰‡é¡æ€ªç‰©é¡ç©å®¶é¡æ•¸æ“šåŒæ­¥é¡æ­¦å™¨é¡ UI UI.SyncValueUI.BoxUI.TextUI.Event æ•¸æ“šåŒæ­¥é¡çŸ©å½¢UIé¡äº‹ä»¶å›èª¿æ–‡å­—UIé¡ Topics ä¸»é¡Œ æ›´æ–°æ—¥èªŒ éŠæˆ²å­˜æª” Examples ç¯„ä¾‹ scenariot_common.lua scenariot_game.lua scenariot_ui.lua tdm_game.lua tdm_ui.lua"},{"title":"å•Ÿç¤ºéŒ„TX Common","path":"/GFBlog/wiki/csolua/scenariot_common.html","content":"123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361--[[ ä¿®æ”¹éŠæˆ²é¸é … ]]Common.UseWeaponInven(true) -- ä½¿ç”¨æ­¦å™¨åº«å­˜åŠŸèƒ½Common.SetSaveCurrentWeapons(true) -- è¨­å®šä¿å­˜ç›®å‰è£å‚™çš„æ­¦å™¨Common.SetSaveWeaponInven(true) -- è¨­å®šä¿å­˜æ­¦å™¨åº«å­˜å…§å®¹ï¼ˆå¿…é ˆå…ˆè¨­å®šUseWeaponInvenï¼‰Common.SetAutoLoad(true) -- è‡ªå‹•è¼‰å…¥å·²å„²å­˜çš„è¨Šæ¯Common.DisableWeaponParts(true) -- åœç”¨æ­¦å™¨é›¶ä»¶åŠŸèƒ½Common.DisableWeaponEnhance(true) -- åœç”¨æ­¦å™¨å¢å¼·åŠŸèƒ½Common.DontGiveDefaultItems(true) -- éŠæˆ²é–‹å§‹æ™‚ä¸æä¾›é è¨­æ­¦å™¨ã€‚Common.DontCheckTeamKill(true) -- å³ä½¿æœ‰åœ˜éšŠæ“Šæ®ºï¼Œä¹Ÿæœƒè¢«è¦–ç‚ºæ™®é€šæ“Šæ®ºã€‚Common.UseScenarioBuymenu(true) -- è®“å•†åº—ä½¿ç”¨å ´æ™¯å•†åº—æ«¥çª—Common.SetNeedMoney(true) -- è¨­å®šè³¼è²·æ§ææ™‚çš„é‡‘éŒ¢éœ€æ±‚ã€‚Common.UseAdvancedMuzzle(true) -- é–‹ç«æ™‚ä»¥æ–°å½¢ç‹€ç¹ªè£½æ§å£ï¼ˆå¿½ç•¥æ¯”ä¾‹ï¼‰Common.SetMuzzleScale(1.0) -- è¨­å®šå°„æ“Šæ™‚çš„æ§å£å°ºå¯¸Common.SetBloodScale(2) -- ä¿®æ”¹å‘½ä¸­æ™‚è¡€é‡æ•ˆæœçš„å¤§å°Common.SetGunsparkScale(10) -- ä¿®æ”¹å­å½ˆæ“Šä¸­ç‰†å£ç­‰æ™‚çš„æ•ˆæœå¤§å°ã€‚Common.SetHitboxScale(2.5) -- ä¿®æ”¹ç¢°æ’ç®±å¤§å°Common.SetMouseoverOutline(true, &#123;r = 255, g = 0, b = 0&#125;) -- ç•¶æ‚¨å°‡æ»‘é¼ åœç•™åœ¨å¯¦é«”ï¼ˆä¾‹å¦‚æ€ªç‰©ï¼‰ä¸Šæ™‚ï¼Œè®“è¼ªå»“å¯è¦‹ã€‚Common.SetUnitedPrimaryAmmoPrice(50) -- å°‡æ‰€æœ‰ä¸»è¦æ­¦å™¨çš„æ¯å€‹å½ˆåŒ£çš„åƒ¹æ ¼çµ±ä¸€ç‚ºæ­¤å€¼ã€‚Common.SetUnitedSecondaryAmmoPrice(0) -- å°‡æ‰€æœ‰è¼”åŠ©æ­¦å™¨çš„æ¯å€‹å½ˆåŒ£çš„åƒ¹æ ¼çµ±ä¸€ç‚ºæ­¤å€¼ã€‚--[[ å…¬å…±å¸¸æ•¸è²æ˜ ]]-- æ¯”è¼ƒå¯¦éš›å€¼æ™‚ä½¿ç”¨EPSILON = 0.00001-- å¾ UI ç™¼é€åˆ°gameçš„è¨Šè™ŸSignalToGame = &#123;\topenWeaponInven = 1,&#125;-- è¨Šè™Ÿå¾gameç™¼é€åˆ° UISignalToUI = &#123;\treloadStarted = 1,\treloadFinished = 2&#125;-- éŠæˆ²ä¸­ä½¿ç”¨çš„æ­¦å™¨é¡åˆ¥WeaponGrade = &#123;\tnormal = 1,\trare = 2,\tunique = 3,\tlegend = 4,\tEND = 4&#125;-- å•†åº—æ­¦å™¨åˆ—è¡¨BuymenuWeaponList =\t&#123;\tCommon.WEAPON.P228,\tCommon.WEAPON.DualBeretta,\tCommon.WEAPON.FiveSeven,\tCommon.WEAPON.Glock18C,\tCommon.WEAPON.USP45,\tCommon.WEAPON.DesertEagle50C,\tCommon.WEAPON.DualInfinity,\tCommon.WEAPON.Galil,\tCommon.WEAPON.FAMAS,\tCommon.WEAPON.M4A1,\tCommon.WEAPON.AK47,\tCommon.WEAPON.OICW,\tCommon.WEAPON.MAC10,\tCommon.WEAPON.UMP45,\tCommon.WEAPON.MP5,\tCommon.WEAPON.TMP,\tCommon.WEAPON.P90,\tCommon.WEAPON.MP7A1ExtendedMag,\tCommon.WEAPON.Needler,\tCommon.WEAPON.M3,\tCommon.WEAPON.XM1014,\tCommon.WEAPON.DoubleBarrelShotgun,\tCommon.WEAPON.WinchesterM1887,\tCommon.WEAPON.USAS12,\tCommon.WEAPON.FireVulcan,\tCommon.WEAPON.M249,\tCommon.WEAPON.MG3,\tCommon.WEAPON.M134Minigun,\tCommon.WEAPON.K3,\tCommon.WEAPON.QBB95,\tCommon.WEAPON.M32MGL,\tCommon.WEAPON.Leviathan,\tCommon.WEAPON.Salamander,\tCommon.WEAPON.RPG7&#125;-- è¨­å®šå•†åº—æ­¦å™¨æ¸…å–®ï¼ˆéœ€è¦UseScenarioBuymenuè¨­å®šï¼‰Common.SetBuymenuWeaponList(BuymenuWeaponList)-- éŠæˆ²ä¸­ä½¿ç”¨çš„æ‰€æœ‰æ­¦å™¨åˆ—è¡¨WeaponList = &#123;\t-- å‰¯æ­¦å™¨åˆ—è¡¨\tCommon.WEAPON.P228,\tCommon.WEAPON.DualBeretta,\tCommon.WEAPON.FiveSeven,\tCommon.WEAPON.Glock18C,\tCommon.WEAPON.USP45,\tCommon.WEAPON.DesertEagle50C,\tCommon.WEAPON.DualInfinity,\tCommon.WEAPON.DualInfinityCustom,\tCommon.WEAPON.DualInfinityFinal,\tCommon.WEAPON.SawedOffM79,\tCommon.WEAPON.Cyclone,\tCommon.WEAPON.AttackM950,\tCommon.WEAPON.DesertEagle50CGold,\tCommon.WEAPON.ThunderGhostWalker,\tCommon.WEAPON.PythonDesperado,\tCommon.WEAPON.DesertEagleCrimsonHunter,\tCommon.WEAPON.DualBerettaGunslinger,\t-- æ­¥æ§æ¸…å–®\tCommon.WEAPON.Galil,\tCommon.WEAPON.FAMAS,\tCommon.WEAPON.M4A1,\tCommon.WEAPON.SG552,\tCommon.WEAPON.AK47,\tCommon.WEAPON.AUG,\tCommon.WEAPON.AN94,\tCommon.WEAPON.M16A4,\tCommon.WEAPON.AK47Custom,\tCommon.WEAPON.HK416,\tCommon.WEAPON.AK74U,\tCommon.WEAPON.AKM,\tCommon.WEAPON.L85A2,\tCommon.WEAPON.FNFNC,\tCommon.WEAPON.TAR21,\tCommon.WEAPON.SCAR,\tCommon.WEAPON.SKULL4,\tCommon.WEAPON.OICW,\tCommon.WEAPON.PlasmaGun,\tCommon.WEAPON.StunRifle,\tCommon.WEAPON.StarChaserAR,\tCommon.WEAPON.CompoundBow,\tCommon.WEAPON.LightningAR2,\tCommon.WEAPON.Ethereal,\tCommon.WEAPON.LightningAR1,\tCommon.WEAPON.F2000,\tCommon.WEAPON.Crossbow,\tCommon.WEAPON.CrossbowAdvance,\tCommon.WEAPON.M4A1DarkKnight,\tCommon.WEAPON.AK47Paladin,\t-- è¡é‹’æ§åˆ—è¡¨\tCommon.WEAPON.MAC10,\tCommon.WEAPON.UMP45,\tCommon.WEAPON.MP5,\tCommon.WEAPON.TMP,\tCommon.WEAPON.P90,\tCommon.WEAPON.MP7A1ExtendedMag,\tCommon.WEAPON.DualKriss,\tCommon.WEAPON.KrissSuperV,\tCommon.WEAPON.DualMP7A1,\tCommon.WEAPON.Tempest,\tCommon.WEAPON.TMPDragon,\tCommon.WEAPON.P90Lapin,\tCommon.WEAPON.DualUZI,\tCommon.WEAPON.Needler,\tCommon.WEAPON.InfinityLaserFist,\t-- éœ°å½ˆæ§æ¸…å–®\tCommon.WEAPON.M3,\tCommon.WEAPON.XM1014,\tCommon.WEAPON.DoubleBarrelShotgun,\tCommon.WEAPON.WinchesterM1887,\tCommon.WEAPON.USAS12,\tCommon.WEAPON.JackHammer,\tCommon.WEAPON.TripleBarrelShotgun,\tCommon.WEAPON.SPAS12Maverick,\tCommon.WEAPON.FireVulcan,\tCommon.WEAPON.BALROGXI,\tCommon.WEAPON.BOUNCER,\tCommon.WEAPON.FlameJackhammer,\tCommon.WEAPON.RailCannon,\tCommon.WEAPON.LightningSG1,\tCommon.WEAPON.USAS12CAMO,\tCommon.WEAPON.WinchesterM1887Gold,\tCommon.WEAPON.UTS15PinkGold,\tCommon.WEAPON.Volcano,\t-- æ©Ÿæ§æ¸…å–®\tCommon.WEAPON.M249,\tCommon.WEAPON.MG3,\tCommon.WEAPON.M134Minigun,\tCommon.WEAPON.MG36,\tCommon.WEAPON.MK48,\tCommon.WEAPON.K3,\tCommon.WEAPON.QBB95,\tCommon.WEAPON.QBB95AdditionalMag,\tCommon.WEAPON.BALROGVII,\tCommon.WEAPON.MG3CSOGSEdition,\tCommon.WEAPON.CHARGER7,\tCommon.WEAPON.ShiningHeartRod,\tCommon.WEAPON.Coilgun,\tCommon.WEAPON.Aeolis,\tCommon.WEAPON.BroadDivine,\tCommon.WEAPON.LaserMinigun,\tCommon.WEAPON.M249Phoenix,\t-- è£å‚™æ­¦å™¨æ¸…å–®\tCommon.WEAPON.M32MGL,\tCommon.WEAPON.PetrolBoomer,\tCommon.WEAPON.Slasher,\tCommon.WEAPON.Eruptor,\tCommon.WEAPON.Leviathan,\tCommon.WEAPON.Salamander,\tCommon.WEAPON.RPG7,\tCommon.WEAPON.M32MGLVenom,\tCommon.WEAPON.Stinger,\tCommon.WEAPON.MagnumDrill,\tCommon.WEAPON.GaeBolg,\tCommon.WEAPON.Ripper,\tCommon.WEAPON.BlackDragonCannon,\tCommon.WEAPON.Guillotine&#125;--[[ ä¿®æ”¹æ¯ç¨®æ­¦å™¨é¡å‹çš„å±¬æ€§ ]]-- æ¬¡è¦æ­¦å™¨å±¬æ€§option = Common.GetWeaponOption(Common.WEAPON.P228)option.price = 100 -- æ­¦å™¨è³¼è²·åƒ¹æ ¼option.damage = 1.0 -- ç•¶èˆ‡ Weapon é¡åˆ¥ä¸€èµ·è¨­å®šæ™‚ï¼Œå…©è€…éƒ½æœƒç›¸ä¹˜ã€‚option.penetration = 1.0 -- æ»²é€ç‡option.rangemod = 1.0 -- åŸºæ–¼è·é›¢çš„å‚·å®³è¡°æ¸›ç‡option.cycletime = 1.0 -- é–‹ç«ç‡option.reloadtime = 1.0 -- é‡æ–°è¼‰å…¥é€Ÿåº¦option.accuracy = 1.0 -- æº–ç¢ºåº¦option.spread = 1.0 -- åŸ·è¡Œæ“ä½œæ™‚æº–ç¢ºåº¦é™ä½çš„ç¨‹åº¦option:SetBulletColor(&#123;r = 255, g = 255, b = 50&#125;); -- é–‹æ§æ™‚ï¼Œæœƒå‡ºç¾æŒ‡å®šé¡è‰²çš„å°„æ“Šè·¯å¾‘ã€‚option.user.grade = WeaponGrade.normal -- é å…ˆå®šç¾©æ¯ç¨®æ­¦å™¨é¡å‹çš„æœ€ä½ç­‰ç´šoption.user.level = 1 -- è³¼è²·æ­¦å™¨æ™‚çš„ç­‰ç´šé™åˆ¶-- æ­¦å™¨å±¬æ€§è©³ç´°è¨­å®šï¼šæ­¦å™¨idã€åƒ¹æ ¼ã€ç­‰ç´šã€å¯ç”¨ç­‰ç´šã€Rã€Gã€Bfunction SetOption(weaponid, price, grade, level, red, green, blue)\toption = Common.GetWeaponOption(weaponid)\toption.price = price\toption.user.grade = grade\toption.user.level = level\tif red ~= nil then option:SetBulletColor(&#123;r = red, g = green, b = blue&#125;);\tendendSetOption(Common.WEAPON.DualBeretta, 100, WeaponGrade.normal, 3, 255, 255, 50)SetOption(Common.WEAPON.FiveSeven, 100, WeaponGrade.normal, 1, 255, 255, 50)SetOption(Common.WEAPON.Glock18C, 100, WeaponGrade.normal, 1, 255, 255, 50)SetOption(Common.WEAPON.USP45, 100, WeaponGrade.normal, 1, 255, 255, 50)SetOption(Common.WEAPON.DesertEagle50C, 500, WeaponGrade.normal, 5, 255, 255, 50)SetOption(Common.WEAPON.DualInfinity, 500, WeaponGrade.normal, 3, 255, 255, 50)SetOption(Common.WEAPON.DualInfinityCustom,\t800, WeaponGrade.normal, 4, 255, 255, 50)SetOption(Common.WEAPON.DualInfinityFinal,\t1500, WeaponGrade.normal, 7, 255, 255, 50)SetOption(Common.WEAPON.SawedOffM79, 1000, WeaponGrade.normal, 5)SetOption(Common.WEAPON.Cyclone, 2000, WeaponGrade.unique, 8)SetOption(Common.WEAPON.AttackM950, 700, WeaponGrade.unique, 5, 255, 255, 50)SetOption(Common.WEAPON.DesertEagle50CGold,\t700, WeaponGrade.unique, 5, 255, 255, 50)SetOption(Common.WEAPON.ThunderGhostWalker, 5000, WeaponGrade.legend, 7)SetOption(Common.WEAPON.PythonDesperado, 8000, WeaponGrade.legend, 15, 255, 255, 50)SetOption(Common.WEAPON.DesertEagleCrimsonHunter,\t7000, WeaponGrade.legend, 12, 255, 255, 50)SetOption(Common.WEAPON.DualBerettaGunslinger, 20000, WeaponGrade.legend, 30, 255, 255, 50)-- æ­¥æ§å±¬æ€§SetOption(Common.WEAPON.Galil, 500, WeaponGrade.normal, 2, 255, 128, 0)SetOption(Common.WEAPON.FAMAS, 500, WeaponGrade.normal, 2, 255, 128, 0)SetOption(Common.WEAPON.M4A1, 700, WeaponGrade.normal, 5, 255, 128, 0)SetOption(Common.WEAPON.SG552, 700, WeaponGrade.normal, 5, 255, 128, 0)SetOption(Common.WEAPON.AK47, 700, WeaponGrade.normal, 5, 255, 128, 0)SetOption(Common.WEAPON.AUG, 700, WeaponGrade.normal, 5, 255, 128, 0)SetOption(Common.WEAPON.AN94, 500, WeaponGrade.normal, 1, 255, 128, 0)SetOption(Common.WEAPON.M16A4, 500, WeaponGrade.normal, 1, 255, 128, 0)SetOption(Common.WEAPON.AK47Custom,\t15000, WeaponGrade.normal, 20, 255, 128, 0)SetOption(Common.WEAPON.HK416, 500, WeaponGrade.normal, 2, 255, 128, 0)SetOption(Common.WEAPON.AK74U, 500, WeaponGrade.normal, 2, 255, 128, 0)SetOption(Common.WEAPON.AKM, 500, WeaponGrade.normal, 2, 255, 128, 0)SetOption(Common.WEAPON.L85A2, 500, WeaponGrade.normal, 2, 255, 128, 0)SetOption(Common.WEAPON.FNFNC, 500, WeaponGrade.normal, 2, 255, 128, 0)SetOption(Common.WEAPON.TAR21, 500, WeaponGrade.normal, 2, 255, 128, 0)SetOption(Common.WEAPON.SCAR, 500, WeaponGrade.normal, 2, 255, 128, 0)SetOption(Common.WEAPON.SKULL4, 5000, WeaponGrade.rare, 10, 255, 128, 0)SetOption(Common.WEAPON.OICW, 1000, WeaponGrade.unique, 5, 255, 128, 0)SetOption(Common.WEAPON.PlasmaGun, 1000, WeaponGrade.unique, 5, 255, 128, 0)SetOption(Common.WEAPON.StunRifle, 7000, WeaponGrade.unique, 15, 255, 128, 0)SetOption(Common.WEAPON.StarChaserAR, 8000, WeaponGrade.unique, 20, 255, 128, 0)SetOption(Common.WEAPON.CompoundBow, 1000, WeaponGrade.unique, 5, 255, 128, 0)SetOption(Common.WEAPON.LightningAR2, 1000, WeaponGrade.unique, 5, 255, 128, 0)SetOption(Common.WEAPON.Ethereal, 1000, WeaponGrade.unique, 5, 255, 128, 0)SetOption(Common.WEAPON.LightningAR1, 1000, WeaponGrade.unique, 5, 255, 128, 0)SetOption(Common.WEAPON.F2000, 1000, WeaponGrade.unique, 5, 255, 128, 0)SetOption(Common.WEAPON.Crossbow, 1000, WeaponGrade.legend, 8, 255, 128, 0)SetOption(Common.WEAPON.CrossbowAdvance,\t2600, WeaponGrade.legend, 8, 255, 128, 0)SetOption(Common.WEAPON.M4A1DarkKnight, 20000, WeaponGrade.legend, 25, 255, 128, 0)SetOption(Common.WEAPON.AK47Paladin, 20000, WeaponGrade.legend, 25, 255, 128, 0)-- è¡é‹’æ§å±¬æ€§SetOption(Common.WEAPON.MAC10, 300, WeaponGrade.normal, 2, 128, 255, 255)SetOption(Common.WEAPON.UMP45, 300, WeaponGrade.normal, 2, 128, 255, 255)SetOption(Common.WEAPON.MP5, 300, WeaponGrade.normal, 3, 128, 255, 255)SetOption(Common.WEAPON.TMP, 300, WeaponGrade.normal, 1, 128, 255, 255)SetOption(Common.WEAPON.P90, 300, WeaponGrade.normal, 1, 128, 255, 255)SetOption(Common.WEAPON.MP7A1ExtendedMag, 2000, WeaponGrade.normal, 10, 128, 255, 255)SetOption(Common.WEAPON.DualKriss, 500, WeaponGrade.normal, 5, 128, 255, 255)SetOption(Common.WEAPON.KrissSuperV, 300, WeaponGrade.normal, 3, 128, 255, 255)SetOption(Common.WEAPON.DualMP7A1, 500, WeaponGrade.normal, 5, 128, 255, 255)SetOption(Common.WEAPON.Tempest, 1000, WeaponGrade.unique, 6, 128, 255, 255)SetOption(Common.WEAPON.TMPDragon, 800, WeaponGrade.unique, 3, 128, 255, 255)SetOption(Common.WEAPON.P90Lapin, 800, WeaponGrade.unique, 3, 128, 255, 255)SetOption(Common.WEAPON.DualUZI, 1200, WeaponGrade.unique, 4, 128, 255, 255)SetOption(Common.WEAPON.Needler, 1000, WeaponGrade.unique, 3, 128, 255, 255)SetOption(Common.WEAPON.InfinityLaserFist, 20000, WeaponGrade.legend, 25)-- éœ°å½ˆæ§å±¬æ€§SetOption(Common.WEAPON.M3, 300, WeaponGrade.normal, 3, 50, 255, 50)SetOption(Common.WEAPON.XM1014, 500, WeaponGrade.normal, 4, 50, 255, 50)SetOption(Common.WEAPON.DoubleBarrelShotgun,\t200, WeaponGrade.normal, 1, 50, 255, 50)SetOption(Common.WEAPON.WinchesterM1887, 500, WeaponGrade.normal, 4, 50, 255, 50)SetOption(Common.WEAPON.USAS12, 700, WeaponGrade.normal, 5, 50, 255, 50)SetOption(Common.WEAPON.JackHammer, 500, WeaponGrade.normal, 3, 50, 255, 50)SetOption(Common.WEAPON.TripleBarrelShotgun,\t600, WeaponGrade.normal, 4, 50, 255, 50)SetOption(Common.WEAPON.SPAS12Maverick, 1200, WeaponGrade.rare, 7, 50, 255, 50)SetOption(Common.WEAPON.FireVulcan, 3000, WeaponGrade.rare, 5, 50, 255, 50)SetOption(Common.WEAPON.BALROGXI, 10000, WeaponGrade.rare, 12, 50, 255, 50)SetOption(Common.WEAPON.BOUNCER, 20000, WeaponGrade.unique, 14)SetOption(Common.WEAPON.FlameJackhammer, 3000, WeaponGrade.unique, 5, 50, 255, 50)SetOption(Common.WEAPON.RailCannon, 3000, WeaponGrade.unique, 5, 50, 255, 50)SetOption(Common.WEAPON.LightningSG1, 3000, WeaponGrade.unique, 5, 50, 255, 50)SetOption(Common.WEAPON.USAS12CAMO, 3000, WeaponGrade.unique, 5, 50, 255, 50)SetOption(Common.WEAPON.WinchesterM1887Gold,\t3000, WeaponGrade.unique, 5, 50, 255, 50)SetOption(Common.WEAPON.UTS15PinkGold, 3000, WeaponGrade.unique, 5, 50, 255, 50)SetOption(Common.WEAPON.Volcano, 15000, WeaponGrade.legend, 14, 50, 255, 50)-- æ©Ÿæ§å±¬æ€§SetOption(Common.WEAPON.M249, 600, WeaponGrade.normal, 3, 255, 50, 255)SetOption(Common.WEAPON.MG3, 1500, WeaponGrade.normal, 7, 255, 50, 255)SetOption(Common.WEAPON.M134Minigun,\t1000, WeaponGrade.normal, 3, 255, 50, 255)SetOption(Common.WEAPON.MG36, 1000, WeaponGrade.normal, 5, 255, 50, 255)SetOption(Common.WEAPON.MK48, 1000, WeaponGrade.normal, 5, 255, 50, 255)SetOption(Common.WEAPON.K3, 600, WeaponGrade.normal, 5, 255, 50, 255)SetOption(Common.WEAPON.QBB95, 800, WeaponGrade.normal, 7, 255, 50, 255)SetOption(Common.WEAPON.QBB95AdditionalMag, 1000, WeaponGrade.normal, 7, 255, 50, 255)SetOption(Common.WEAPON.BALROGVII, 2500, WeaponGrade.rare, 7, 255, 50, 255)SetOption(Common.WEAPON.MG3CSOGSEdition, 2500, WeaponGrade.rare, 7, 255, 50, 255)SetOption(Common.WEAPON.CHARGER7, 5000, WeaponGrade.rare, 7, 255, 50, 255)SetOption(Common.WEAPON.ShiningHeartRod, 8000, WeaponGrade.unique, 12, 255, 50, 255)SetOption(Common.WEAPON.Coilgun, 5000, WeaponGrade.unique, 7, 255, 50, 255)SetOption(Common.WEAPON.Aeolis, 5000, WeaponGrade.unique, 7, 255, 50, 255)SetOption(Common.WEAPON.BroadDivine, 7000, WeaponGrade.unique, 10, 255, 50, 255)SetOption(Common.WEAPON.LaserMinigun, 7000, WeaponGrade.unique, 10)SetOption(Common.WEAPON.M249Phoenix, 30000, WeaponGrade.legend, 25, 255, 50, 255)-- è£å‚™æ­¦å™¨å±¬æ€§SetOption(Common.WEAPON.M32MGL, 3000, WeaponGrade.normal, 5)SetOption(Common.WEAPON.PetrolBoomer,\t3000, WeaponGrade.normal, 5)SetOption(Common.WEAPON.Slasher, 3000, WeaponGrade.normal, 5)SetOption(Common.WEAPON.Eruptor, 300, WeaponGrade.normal, 1)SetOption(Common.WEAPON.Leviathan, 2000, WeaponGrade.normal, 7)SetOption(Common.WEAPON.Salamander, 2000, WeaponGrade.normal, 7)SetOption(Common.WEAPON.RPG7, 1200, WeaponGrade.normal, 3)SetOption(Common.WEAPON.M32MGLVenom,\t5000, WeaponGrade.unique, 15)SetOption(Common.WEAPON.Stinger, 3000, WeaponGrade.unique, 3)SetOption(Common.WEAPON.MagnumDrill,\t20000, WeaponGrade.legend, 25, 50, 50, 255)SetOption(Common.WEAPON.GaeBolg, 10000, WeaponGrade.legend, 15)SetOption(Common.WEAPON.Ripper, 15000, WeaponGrade.legend, 20)SetOption(Common.WEAPON.BlackDragonCannon, 10000, WeaponGrade.legend, 7)SetOption(Common.WEAPON.Guillotine, 10000, WeaponGrade.legend, 10)"},{"title":"å•Ÿç¤ºéŒ„TX UI","path":"/GFBlog/wiki/csolua/scenariot_ui.html","content":"123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384screen = UI.ScreenSize()center = &#123;x = screen.width / 2, y = screen.height / 2&#125;--[[ é¡¯ç¤ºåº«å­˜å¯†é‘° ]]weaponInvenKeyText = UI.Text.Create()weaponInvenKeyText:Set(&#123;text = &#x27;ì¸ë²¤í† ë¦¬ : [B]&#x27;, font=&#x27;small&#x27;, align=&#x27;right&#x27;, x = center.x + 80, y = screen.height - 25, width = 185, height = 30, r = 255, g = 200, b = 0, a = 100&#125;)--[[ è¼‰å…¥ä¸­ ui ]]reloadingInit = falsereloadingBG = UI.Box.Create()reloadingGauge = UI.Box.Create()reloadingText = UI.Text.Create()reloadingBG:Hide()reloadingGauge:Hide()reloadingText:Hide()reloadTime = 0 -- é‡æ–°è¼‰å…¥æ‰€éœ€æ™‚é–“reloadStartTime = 0 -- é‡æ–°è¼‰å…¥é–‹å§‹æ™‚é–“reloadTimeSync = UI.SyncValue.Create(&quot;reloadTime&quot;)function reloadTimeSync:OnSync()\treloadTime = self.valueendfunction UI.Event:OnUpdate(time)\tif reloadingBG:IsVisible() and reloadTime &gt; EPSILON then if reloadStartTime &lt; EPSILON then reloadStartTime = time else -- é€éè¨ˆç®—è‡ªè¼‰å…¥é–‹å§‹ä»¥ä¾†ç¶“éçš„æ™‚é–“ä¾†è®Šæ›´å„€è¡¨çš„å¯¬åº¦ã€‚ local diff = time - reloadStartTime local ratio = diff / reloadTime if ratio &gt; 1 then reloadingBG:Hide() reloadingGauge:Hide() reloadingText:Hide() reloadingGauge:Set(&#123;width = 0&#125;) reloadTime = 0 else reloadingGauge:Set(&#123;width = 100 * ratio&#125;) end end\tendend--[[ äº‹ä»¶å‡½æ•¸ ]]-- æŒ‰éµæ™‚çš„äº‹ä»¶å‡½æ•¸function UI.Event:OnKeyDown(inputs)\tif inputs[UI.KEY.B] then UI.Signal(SignalToGame.openWeaponInven)\tendend-- é€égameå‚³éè¨Šæ¯function UI.Event:OnSignal(signal)\tif signal == SignalToUI.reloadStarted then -- ç¬¬ä¸€æ¬¡æ‰“é–‹æ™‚å¡«å¯«è³‡æ–™ if reloadingInit == false then reloadingInit = true reloadingBG:Set(&#123;x = center.x - 50, y = center.y - 20, width = 100, height = 27, r = 25, g = 25, b = 25, a = 220&#125;) reloadingGauge:Set(&#123;x = center.x - 50, y = center.y - 20, width = 100, height = 27, r = 100, g = 120, b = 150, a = 220&#125;) reloadingText:Set(&#123;text = &#x27;ì¥ì „ì¤‘&#x27;, font=&#x27;small&#x27;, align=&#x27;center&#x27;, x = center.x - 50, y = center.y - 4, width = 100, height = 20, r = 255, g = 255, b = 255&#125;) end reloadingBG:Show() reloadingGauge:Show() reloadingText:Show() reloadingGauge:Set(&#123;width = 0&#125;) reloadStartTime = 0 reloadTime = 0\telseif signal == SignalToUI.reloadFinished then reloadingBG:Hide() reloadingGauge:Hide() reloadingText:Hide() reloadingGauge:Set(&#123;width = 0&#125;) reloadTime = 0\tendend"},{"title":"åœ˜éšŠæ­»é¬¥ Game","path":"/GFBlog/wiki/csolua/tdm_game.html","content":"12345678910111213141516171819202122232425262728293031323334353637383940-- åœ˜éšŠæ­»äº¡ç«¶è³½ç¯„ä¾‹(game)local TDM = Game.RuleTDM.name = &quot;íŒ€ë°ìŠ¤ë§¤ì¹˜&quot;TDM.desc = &quot;ìŠ¤í¬ë¦½íŠ¸ë¡œ ë§Œë“œëŠ” íŒ€ë° ëª¨ë“œ&quot;-- åœ°åœ–å¯ä»¥è¢«ç ´å£TDM.breakable = true-- ç›®æ¨™åˆ†æ•¸local MaxKill = Game.SyncValue.Create(&quot;MaxKill&quot;)MaxKill.value = 30-- åœ˜éšŠå¾—åˆ†local Score = &#123;&#125;Score[Game.TEAM.CT] = Game.SyncValue.Create(&quot;ScoreCT&quot;)Score[Game.TEAM.CT].value = 0Score[Game.TEAM.TR] = Game.SyncValue.Create(&quot;ScoreTR&quot;)Score[Game.TEAM.TR].value = 0function TDM:OnPlayerSpawn(player) player:ShowBuymenu()endfunction TDM:OnPlayerKilled(victim, killer) -- è‡ªæ®ºã€è·Œå€’ç­‰ã€‚ if killer == nil then return end -- æ®ºæ­»ç©å®¶çš„éšŠä¼å¾— 1 åˆ† local killer_team = killer.team local point = Score[killer_team] point.value = point.value + 1 -- å¦‚æœä½ è¶…éäº†ç›®æ¨™ï¼Œä½ å°±è´äº†ï¼ if (point.value &gt;= MaxKill.value) then self:Win(killer_team) endend"},{"title":"åœ˜éšŠæ­»é¬¥ UI","path":"/GFBlog/wiki/csolua/tdm_ui.html","content":"1234567891011121314151617181920212223242526272829303132333435363738394041-- åœ˜éšŠæ­»äº¡ç«¶è³½ç¯„ä¾‹(ui)-- éœ€è¦åœ¨ä¼ºæœå™¨ä¸ŠåŒæ­¥çš„åˆ†æ•¸è®Šæ•¸ScoreCT = UI.SyncValue.Create(&quot;ScoreCT&quot;)ScoreTR = UI.SyncValue.Create(&quot;ScoreTR&quot;)MaxKill = UI.SyncValue.Create(&quot;MaxKill&quot;)-- å‰µå»ºè¨˜åˆ†ç‰Œscreen = UI.ScreenSize()center = &#123;x = screen.width / 2, y = screen.height / 2&#125;scoreBG = UI.Box.Create()scoreBG:Set(&#123;x = center.x - 100, y = 0, width = 200, height = 50, r = 255, g = 255, b = 255, a = 150&#125;)goalBG = UI.Box.Create()goalBG:Set(&#123;x = center.x - 50, y = 0, width = 100, height = 50, r = 40, g = 40, b = 40, a = 150&#125;)goalLabel = UI.Text.Create()goalLabel:Set(&#123;text=&#x27;00&#x27;, font=&#x27;large&#x27;, align=&#x27;center&#x27;, x = center.x - 50, y = 10, width = 100, height = 50, r = 80, g = 255, b = 80&#125;)ctLabel = UI.Text.Create()ctLabel:Set(&#123;text=&#x27;00&#x27;, font=&#x27;medium&#x27;, align=&#x27;left&#x27;, x = center.x - 95, y = 20, width = 50, height = 50, r = 80, g = 80, b = 255&#125;)trLabel = UI.Text.Create()trLabel:Set(&#123;text=&#x27;00&#x27;, font=&#x27;medium&#x27;, align=&#x27;right&#x27;, x = center.x + 45, y = 20, width = 50, height = 50, r = 255, g = 80, b = 80&#125;)-- æ¯æ¬¡åŒæ­¥è®Šæ•¸æ™‚ï¼Œè¨˜åˆ†æ¿éƒ½æœƒæ›´æ–°ã€‚function ScoreCT:OnSync() local str = string.format(&quot;%02d&quot;, self.value) ctLabel:Set(&#123;text = str&#125;)endfunction ScoreTR:OnSync() local str = string.format(&quot;%02d&quot;, self.value) trLabel:Set(&#123;text = str&#125;)endfunction MaxKill:OnSync() local str = string.format(&quot;%02d&quot;, self.value) goalLabel:Set(&#123;text = str&#125;)end"},{"title":"å•Ÿç¤ºéŒ„TX Game","path":"/GFBlog/wiki/csolua/scenariot_game.html","content":"12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989910010110210310410510610710810911011111211311411511611711811912012112212312412512612712812913013113213313413513613713813914014114214314414514614714814915015115215315415515615715815916016116216316416516616716816917017117217317417517617717817918018118218318418518618718818919019119219319419519619719819920020120220320420520620720820921021121221321421521621721821922022122222322422522622722822923023123223323423523623723823924024124224324424524624724824925025125225325425525625725825926026126226326426526626726826927027127227327427527627727827928028128228328428528628728828929029129229329429529629729829930030130230330430530630730830931031131231331431531631731831932032132232332432532632732832933033133233333433533633733833934034134234334434534634734834935035135235335435535635735835936036136236336436536636736836937037137237337437537637737837938038138238338438538638738838939039139239339439539639739839940040140240340440540640740840941041141241341441541641741841942042142242342442542642742842943043143243343443543643743843944044144244344444544644744844945045145245345445545645745845946046146246346446546646746846947047147247347447547647747847948048148248348448548648748848949049149249349449549649749849950050150250350450550650750850951051151251351451551651751851952052152252352452552652752852953053153253353453553653753853954054154254354454554654754854955055155255355455555655755855956056156256356456556656756856957057157257357457557657757857958058158258358458558658758858959059159259359459559659759859960060160260360460560660760860961061161261361461561661761861962062162262362462562662762862963063163263363463563663763863964064164264364464564664764864965065165265365465565665765865966066166266366466566666766866967067167267367467567667767867968068168268368468568668768868969069169269369469569669769869970070170270370470570670770870971071171271371471571671771871972072172272372472572672772872973073173273373473573673773873974074174274374474574674774874975075175275375475575675775875976076176276376476576676776876977077177277377477577677777877978078178278378478578678778878979079179279379479579679779879980080180280380480580680780880981081181281381481581681781881982082182282382482582682782882983083183283383483583683783883984084184284384484584684784884985085185285385485585685785885986086186286386486586686786886987087187287387487587687787887988088188288388488588688788888989089189289389489589689789889990090190290390490590690790890991091191291391491591691791891992092192292392492592692792892993093193293393493593693793893994094194294394494594694794894995095195295395495595695795895996096196296396496596696796896997097197297397497597697797897998098198298398498598698798898999099199299399499599699799899910001001100210031004100510061007100810091010101110121013101410151016101710181019102010211022102310241025102610271028102910301031103210331034103510361037103810391040104110421043104410451046104710481049105010511052105310541055105610571058105910601061106210631064106510661067106810691070107110721073107410751076107710781079108010811082108310841085108610871088108910901091109210931094109510961097109810991100110111021103110411051106110711081109111011111112111311141115111611171118111911201121--[[ äº‹å…ˆå®šç¾©gameä¸­æ‰€éœ€çš„å¸¸æ•¸å’Œè®Šæ•¸ ]]players = &#123;&#125;difficultySelectPlayer = 0 -- ç©å®¶ç´¢å¼•é¸æ“‡æˆ–é¸æ“‡é›£åº¦ç´šåˆ¥-- è¨­å®šæ­¦å™¨å’Œæ€ªç‰©èƒ½åŠ›ç­‰æ™‚æ‰€ä½¿ç”¨çš„æ¨™æº–ç­‰ç´šã€‚MonsterLevel = 1 -- æ€ªç‰©ç­‰ç´šLEVEL_MIN = 1 -- æœ€ä½ç©å®¶ç­‰ç´šLEVEL_MAX = 99 -- ç©å®¶æœ€é«˜ç­‰ç´šWEAPONLEVEL_MAX = 60 -- æ­¦å™¨æœ€å¤§ç­‰ç´šmapDifficulty = SignalToGame.difficulty0 -- ç›®å‰åœ°åœ–é›£åº¦-- æ­¦å™¨å’Œæ€ªç‰©çš„å„ç¨®èƒ½åŠ›æ˜¯æ ¹æ“šå…¶ç­‰ç´šä¹˜ä»¥ä»¥ä¸‹æ•¸å€¼ä¾†ä½¿ç”¨çš„ã€‚LevelRatio = &#123;\t1.000,\t1.050,\t1.103,\t1.158,\t1.216,\t1.276,\t1.340,\t1.407,\t1.477,\t1.551,\t1.629,\t1.710,\t1.796,\t1.886,\t1.980,\t2.079,\t2.183,\t2.292,\t2.407,\t2.527,\t2.653,\t2.786,\t2.925,\t3.072,\t3.225,\t3.386,\t3.556,\t3.733,\t3.920,\t4.116,\t4.322,\t4.538,\t4.765,\t5.003,\t5.253,\t5.516,\t5.792,\t6.081,\t6.385,\t6.705,\t7.040,\t7.392,\t7.762,\t8.150,\t8.557,\t8.985,\t9.434,\t9.906,\t10.401,\t10.921,\t11.467,\t12.041,\t12.643,\t13.275,\t13.939,\t14.636,\t15.367,\t16.136,\t16.943,\t17.790,\t18.679,\t19.613,\t20.594,\t21.623,\t22.705,\t23.840,\t25.032,\t26.283,\t27.598,\t28.978,\t30.426,\t31.948,\t33.545,\t35.222,\t36.984,\t38.833,\t40.774,\t42.813,\t44.954,\t47.201,\t49.561,\t52.040,\t54.641,\t57.374,\t60.242,\t63.254,\t66.417,\t69.738,\t73.225,\t76.886,\t80.730,\t84.767,\t89.005,\t93.455,\t98.128,\t103.035,\t108.186,\t113.596,\t119.276,&#125;-- æ­¦å™¨ç­‰ç´šåˆ¤å®šæ©Ÿç‡WeaponGradeProb = &#123;\t1.0,\t0.2,\t0.05,\t0.005&#125;-- æŒ‰æ­¦å™¨é¡åˆ¥åŠƒåˆ†çš„åŸºæœ¬å‚·å®³WeaponGradeDamage = &#123;\t1.0,\t1.25,\t1.5,\t2.0&#125;-- æ­¦å™¨éš¨æ©Ÿå‚·å®³ï¼ˆå¦‚æœæ˜¯0.15ï¼Œå‰‡åœ¨0.85åˆ°1.15ä¹‹é–“éš¨æ©Ÿç”¢ç”Ÿï¼‰WeaponRandomDamage = 0.15-- æŒ‰æ­¦å™¨ç­‰ç´šåŠƒåˆ†çš„å‚·å®³WeaponLevelDamage = 1.0-- ä¿å­˜éŠæˆ²ä¸­ä½¿ç”¨çš„æ€ªç‰©é¡å‹MonsterTypes = &#123;\tGame.MONSTERTYPE.NORMAL0,\tGame.MONSTERTYPE.NORMAL1,\tGame.MONSTERTYPE.NORMAL2,\tGame.MONSTERTYPE.NORMAL3,\tGame.MONSTERTYPE.NORMAL4,\tGame.MONSTERTYPE.NORMAL5,\tGame.MONSTERTYPE.NORMAL6,\tGame.MONSTERTYPE.RUNNER0,\tGame.MONSTERTYPE.RUNNER1,\tGame.MONSTERTYPE.RUNNER2,\tGame.MONSTERTYPE.RUNNER3,\tGame.MONSTERTYPE.RUNNER4,\tGame.MONSTERTYPE.RUNNER5,\tGame.MONSTERTYPE.RUNNER6,\tGame.MONSTERTYPE.HEAVY1,\tGame.MONSTERTYPE.HEAVY2,\tGame.MONSTERTYPE.A101AR,\tGame.MONSTERTYPE.A104RL,&#125;-- éŠæˆ²ä¸­ä½¿ç”¨çš„æ€ªç‰©é¡åˆ¥çš„å®šç¾©MonsterGrade = &#123;\tnormal = 1,\trare = 2,\tunique = 3,\tlegend = 4,\tEND = 4&#125;-- çµ±è¨ˆæ¯å€‹æ€ªç‰©çµ„ï¼ˆçµ„ï¼‰æ˜¯å¦æ­»äº¡çš„è¡¨æ ¼monsterGroupCnt = &#123;&#125;-- æ€ªç‰©æ³¢ç®¡ç†è¡¨ï¼ˆèˆ‡æ€ªç‰©ç”Ÿæˆå™¨é¡ä¼¼çš„è¡Œç‚ºï¼‰monsterWaveCnt = &#123;&#125;monsterWavePosition = &#123;&#125;-- æ˜¯å¦å°ä»˜waveæ€ªWaveFuncState = &#123;\tenable = 1, -- å•Ÿç”¨wave\tdisable = 3, -- ç¦ç”¨wave&#125;monsterWaveFuncState = WaveFuncState.enable-- æ€ªç‰©ç­‰ç´šåˆ¤å®šæ©Ÿç‡MonsterGradeProb = &#123;\t1.0,\t0.3,\t0.1,\t0.01&#125;-- ä¸åŒæ€ªç‰©ç­‰ç´šçš„æ­¦å™¨æ‰è½æ©Ÿç‡ï¼ˆæœ€å¤§ 1.0ï¼‰WeaponDropProb = &#123;\t0.035,\t0.08,\t0.08,\t1&#125;-- ç‚ºæ¯å€‹æ€ªç‰©ç­‰ç´šè¨­å®šæ•¸å€¼MonsterLevelVar = &#123;\tnormal =\t&#123;hpMin = 30, hpMax = 60, armorMin = 5, armorMax = 30, damageMin = 10, damageMax = 20, coinMin = 1, coinMax = 5&#125;,\trunner =\t&#123;hpMin = 20, hpMax = 50, armorMin = 0, armorMax = 20, damageMin = 10, damageMax = 30, coinMin = 3, coinMax = 8&#125;,\theavy = &#123;hpMin = 150, hpMax = 250, armorMin = 20, armorMax = 55, damageMin = 20, damageMax = 40, coinMin = 10, coinMax = 15&#125;,\ta101ar =\t&#123;hpMin = 150, hpMax = 250, armorMin = 30, armorMax = 50, damageMin = 4, damageMax = 4, coinMin = 20, coinMax = 25&#125;,\ta104rl =\t&#123;hpMin = 150, hpMax = 250, armorMin = 30, armorMax = 50, damageMin = 17, damageMax = 17, coinMin = 20, coinMax = 25&#125;,\tetc = &#123;hpMin = 20, hpMax = 50, armorMin = 0, armorMax = 20, damageMin = 10, damageMax = 35, coinMin = 3, coinMax = 8&#125;,&#125;-- åŸºæ–¼æ€ªç‰©ç”Ÿå‘½å€¼çš„ç¶“é©—å€¼ï¼ˆexp == hp * MonsterExpMultï¼‰MonsterExpMult = 0.6-- è¨­å®šæ¯å€‹ç­‰ç´šçš„æœ€é«˜ç­‰ç´šå’Œæ‰€éœ€ç¶“é©—PlayerRequireExp = &#123;\t87,\t360,\t864,\t1584,\t2625,\t3996,\t5586,\t7680,\t10206,\t13200,\t17061,\t21168,\t25857,\t31752,\t38475,\t45312,\t53754,\t64152,\t74727,\t87600,\t100548,\t116160,\t133308,\t152064,\t174375,\t196716,\t223074,\t251664,\t285099,\t318600,\t357492,\t402432,\t447579,\t499392,\t554925,\t618192,\t685869,\t758100,\t839592,\t926400,\t1023729,\t1127196,\t1236981,\t1359072,\t1494450,\t1637784,\t1795917,\t1969920,\t2153697,\t2355000,\t2574990,\t2806752,\t3067428,\t3341736,\t3639075,\t3960768,\t4308174,\t4682688,\t5096184,\t5529600,\t5994531,\t6504048,\t7060851,\t7643136,\t8276775,\t8964648,\t9696240,\t10487232,\t11340702,\t12245100,\t13232625,\t14292288,\t15427455,\t16641564,\t17955000,\t19355376,\t20864151,\t22486464,\t24208839,\t26073600,\t28067958,\t30217656,\t32509191,\t34948368,\t37584450,\t40404348,\t43415784,\t46626624,\t50092404,\t53775900,\t57735132,\t61956480,\t66476214,\t71306520,\t76486875,\t82003968,\t87898878,\t94215240,\t100000000&#125;--[[ æ€ªç‰©ç›¸é—œçš„ç”¨æˆ¶è‡ªè¨‚å‡½æ•¸ ]]-- æ ¹æ“šç­‰ç´šè¨­å®šæ€ªç‰©èƒ½åŠ›function SetMonsterAttribute(monster, grade)\tif monster == nil then return\tend\tmonster.user.level = monsterLevel\tmonster.user.grade = grade\tmonster.applyKnockback = true -- ä½¿æ€ªç‰©èƒ½å¤ å—åˆ°æ“Šé€€\tmonster.canJump = false -- é˜²æ­¢æ€ªç‰©è·³èº\tmonster.viewDistance = 12 -- ç™¼ç¾æ•µäººçš„è¦–é‡ç¯„åœ\tlocal levelVar\tif Game.MONSTERTYPE.NORMAL0 &lt;= monster.type and monster.type &lt;= Game.MONSTERTYPE.NORMAL6 then levelVar = MonsterLevelVar.normal\telseif Game.MONSTERTYPE.RUNNER0 &lt;= monster.type and monster.type &lt;= Game.MONSTERTYPE.RUNNER6 then levelVar = MonsterLevelVar.runner\telseif Game.MONSTERTYPE.HEAVY1 &lt;= monster.type and monster.type &lt;= Game.MONSTERTYPE.HEAVY2 then levelVar = MonsterLevelVar.heavy\telseif monster.type == Game.MONSTERTYPE.A101AR then levelVar = MonsterLevelVar.a101ar\telseif monster.type == Game.MONSTERTYPE.A104RL then levelVar = MonsterLevelVar.a104rl\telse levelVar = MonsterLevelVar.etc\tend\t-- å‚·å®³æ¯”å…¶ä»–å€¼æ›´æ¼¸é€²\tlocal damageMult = ((LevelRatio[monsterLevel] - 1.0) * 0.5) + 1.0\tmonster.damage = math.floor(Game.RandomInt(levelVar.damageMin, levelVar.damageMax) * damageMult)\tmonster.health = math.floor(Game.RandomInt(levelVar.hpMin, levelVar.hpMax) * LevelRatio[monsterLevel])\tmonster.coin = math.floor(Game.RandomInt(levelVar.coinMin, levelVar.coinMax) * LevelRatio[monsterLevel])\tmonster.user.exp = math.floor(monster.health * MonsterExpMult) -- ç©å®¶æ•æ‰è©²æ€ªç‰©æ™‚å°‡ç²å¾—çš„ç¶“é©—å€¼\t-- æ ¹æ“šç¢ºå®šçš„ç­‰ç´šè¨­å®šé¡è‰²å’Œèƒ½åŠ›\tif grade == MonsterGrade.rare then monster:SetRenderFX(Game.RENDERFX.GLOWSHELL) monster:SetRenderColor(&#123;r = 0, g = 30, b = 255&#125;) monster.health = math.floor(monster.health * 3.0) monster.damage = monster.damage * 1.5 monster.speed = 1.5 monster.user.exp = math.floor(monster.user.exp * 1.5)\telseif grade == MonsterGrade.unique then monster:SetRenderFX(Game.RENDERFX.GLOWSHELL) monster:SetRenderColor(&#123;r = 255, g = 30, b = 30&#125;) monster.health = math.floor(monster.health * 5.0) monster.damage = monster.damage * 2.0 monster.speed = 1.5 monster.user.exp = math.floor(monster.user.exp * 3.0)\telseif grade == MonsterGrade.legend then monster:SetRenderFX(Game.RENDERFX.GLOWSHELL) monster:SetRenderColor(&#123;r = 255, g = 255, b = 100&#125;) monster.health = math.floor(monster.health * 12.0) monster.damage = monster.damage * 2.0 monster.speed = 2.5 monster.user.exp = math.floor(monster.user.exp * 10.0)\tendend-- åœ¨æŒ‡å®šåœ°é»å‰µé€ ä¸€ç¾¤æ€ªç‰©function CreateMonsters(type, num, pos, groupid, grade)\tif grade == nil then grade = MonsterGrade.normal\tend\tresult = &#123;&#125;\t-- å‰µé€ numæ•¸é‡çš„æ€ªç‰©\tfor i = 1, num do monster = Game.Monster.Create(type, pos) if monster then -- ä¾æ€ªç‰©ç­‰ç´šè¨­å®šèƒ½åŠ› SetMonsterAttribute(monster, grade) -- å„²å­˜æ€ªç‰©æ‰€å±¬çš„çµ„è™Ÿï¼Œä¸¦å°‡æ­¤çµ„è™ŸåŠ ä¸€ monster.user.groupid = groupid if monsterGroupCnt[groupid] then monsterGroupCnt[groupid] = monsterGroupCnt[groupid] + 1 else monsterGroupCnt[groupid] = 1; end -- ä¿å­˜çµæœ table.insert(result, monster) end\tend\treturn resultend-- ç•¶æ‰€æœ‰æ€ªç‰©éƒ½æ­»æ‰æ™‚æ‰€å‘¼å«çš„å‡½æ•¸function OnMonsterKilled(monster) if monster.user.waveFunc then if monsterWaveFuncState == WaveFuncState.enable then monster.user.waveFunc(true, monster.user.waveFuncArg) else monster.user.waveFunc = nil end end -- bossåœ˜æ­»äº† if monster.user.groupid == 8055 then monsterWaveFuncState = WaveFuncState.disable difficultySelectPlayer = 0 Game.KillAllMonsters() -- ä¸‹æ¬¡æ›´æ–°å¾Œæ®ºæ­»æ‰€æœ‰æ€ªç‰© end Game.SetTrigger(&#x27;OnMonsterKilled&#x27; .. monster.user.groupid, true)end--[[ æ­¦å™¨ç›¸é—œè‡ªè¨‚å‡½æ•¸ ]]-- è¨­å®šæ‰€æœ‰æ­¦å™¨çš„æœ€ä½åŸºç¤çµ±è¨ˆæ•¸æ“šfunction SetWeaponAttributeDefault(weapon)\tif weapon == nil then return\tend\t-- å‰¯æ­¦å™¨æœ‰ç„¡é™å½ˆåŒ£\tif weapon:GetWeaponType() == Game.WEAPONTYPE.PISTOL then weapon.infiniteclip = true\telse weapon:AddClip1(3) -- æä¾›3å€‹æ¨™æº–å½ˆåŒ£\tend\t-- åŸºæœ¬æ°´å¹³\tif weapon.user.level == nil then weapon.user.level = Common.GetWeaponOption(weapon.weaponid).user.level\tend\t-- åŸºæœ¬æ°´å¹³\tweapon.user.grade = WeaponGrade.normal\tweapon.color = Game.WEAPONCOLOR.WHITEend-- ä¾ç­‰ç´šè¨­å®šæ­¦å™¨èƒ½åŠ›function SetWeaponAttribute(weapon, level)\tif weapon == nil then return\tend\t-- åŸºæœ¬èƒ½åŠ›è¨­å®š\tSetWeaponAttributeDefault(weapon)\t-- ç­‰ç´šè¨­å®š\tweapon.user.level = level\t-- å–å¾—ç›®å‰æ­¦å™¨çš„WeaponOptionå’Œç­‰ç´šã€‚\tlocal option = Common.GetWeaponOption(weapon.weaponid)\tlocal grade = option.user.grade\t-- æŒ‰ç­‰ç´šæ±ºå®šå‡ºç¾æ©Ÿç‡\tlocal weightMax = 0.0\tfor i = grade, WeaponGrade.END do weightMax = weightMax + WeaponGradeProb[i]\tend\tlocal weight = Game.RandomFloat(0.0, weightMax)\tlocal weightSum = 0.0\tfor i = grade, WeaponGrade.END do weightSum = weightSum + WeaponGradeProb[i] if weight &lt;= weightSum then grade = i break end\tend\t-- æŒ‰ç­‰ç´šã€ç­‰ç´šå’Œéš¨æ©Ÿé€²è¡Œå‚·å®³è¨ˆç®—\tweapon.damage = WeaponLevelDamage * LevelRatio[level]\tweapon.damage = weapon.damage * (WeaponGradeDamage[grade] + Game.RandomFloat(-WeaponRandomDamage, WeaponRandomDamage))\t-- éš¨æ©Ÿèƒ½åŠ›çš„æœ€å¤§æ•¸é‡\tlocal maxAttrNum = 0\t-- æ ¹æ“šç¢ºå®šçš„ç­‰ç´šè¨­å®šèƒ½åŠ›çš„é¡è‰²å’Œæ•¸é‡\tif grade == WeaponGrade.normal then weapon.color = Game.WEAPONCOLOR.WHITE maxAttrNum = 0\telseif grade == WeaponGrade.rare then weapon.color = Game.WEAPONCOLOR.BLUE maxAttrNum = 1\telseif grade == WeaponGrade.unique then weapon.color = Game.WEAPONCOLOR.RED maxAttrNum = 2\telseif grade == WeaponGrade.legend then weapon.color = Game.WEAPONCOLOR.ORANGE maxAttrNum = 3\tend\t-- é˜²æ­¢é‡è¤‡å‡ºç¾çš„èƒ½åŠ›\tlocal attrDuplicateCheck = &#123;&#125;\tif weapon:GetWeaponType() == Game.WEAPONTYPE.PISTOL then attrDuplicateCheck[5] = true\tend\t-- èƒ½åŠ›åˆ†æ•¸åˆ¤å®š\tlocal attrNum = Game.RandomInt(0, maxAttrNum)\tfor i = 1, attrNum do local attrType = Game.RandomInt(1, 5) -- å¾speedåˆ°infiniteclipçš„ 5 ç¨®é¡å‹ if attrDuplicateCheck[attrType] then -- å¦‚æœèƒ½åŠ›é‡ç–Šçš„è©± i = i - 1 else attrDuplicateCheck[attrType] = true if attrType == 1 then weapon.speed = Game.RandomFloat(1.2, 1.3) elseif attrType == 2 then weapon.knockback = Game.RandomFloat(1.2, 2.0) weapon.flinch = Game.RandomFloat(1.2, 2.0) elseif attrType == 3 then weapon.criticalrate = Game.RandomFloat(0.03, 0.2) weapon.criticaldamage = Game.RandomFloat(1.5, 2.5) elseif attrType == 4 then weapon.bloodsucking = Game.RandomFloat(0.01, 0.03) elseif attrType == 5 then weapon.infiniteclip = true end end\tendend-- éš¨æ©ŸåŒ–æ­¦å™¨ç­‰ç´šï¼ˆä½¿ç”¨æ€ªç‰©ç­‰ç´šï¼‰function GetWeaponRandomLevel(level)\tlocal minLevel = level - 5\tlocal maxLevel = level + 3\tif minLevel &lt; LEVEL_MIN then minLevel = LEVEL_MIN\tend\tif maxLevel &gt; WEAPONLEVEL_MAX then maxLevel = WEAPONLEVEL_MAX\tend\treturn Game.RandomInt(minLevel, maxLevel)end-- éš¨æ©Ÿæ­¦å™¨ç”Ÿæˆï¼ˆä½¿ç”¨ç­‰ç´šã€ä½ç½®ï¼‰function CreateWeapon(level, pos)\t-- éš¨æ©Ÿæ±ºå®šæ­¦å™¨é¡å‹ï¼ˆä½¿ç”¨æ­¦å™¨ç­‰ç´šï¼‰\tlocal weightMax = 0.0\tlocal list = &#123;&#125;\tfor i = 1, #WeaponList do local weaponOption = Common.GetWeaponOption(WeaponList[i]) if weaponOption.user.level &lt;= level then table.insert(list, weaponOption) weightMax = weightMax + (LevelRatio[weaponOption.user.level] * WeaponGradeProb[weaponOption.user.grade]) end\tend\tlocal type = 0\tlocal weightSum = 0.0\tlocal weight = Game.RandomFloat(0.0, weightMax)\tfor i = 1, #list do weightSum = weightSum + (LevelRatio[list[i].user.level] * WeaponGradeProb[list[i].user.grade]) if weight &lt;= weightSum then type = list[i].weaponid break end\tend\tif type == 0 then return nil\tend\tlocal weapon = Game.Weapon.CreateAndDrop(type, pos)\tif weapon then SetWeaponAttribute(weapon, level)\tend\treturn weaponend--[[ èˆ‡ç©å®¶ç­‰ç´šç›¸é—œçš„è‡ªè¨‚åŠŸèƒ½ ]]-- ç•¶ç©å®¶å‡ç´šæ™‚function OnLevelUp(player)\t-- å¢åŠ è€åŠ›\tplayer.maxhealth = math.floor(100 * LevelRatio[player.user.level])\tplayer.health = player.maxhealth\t-- åœ¨æ™®é€šé›£åº¦ä¸‹ï¼Œæ€ªç‰©ç­‰ç´šæœƒæ ¹æ“šç©å®¶ç­‰ç´šè€Œè®ŠåŒ–\tif mapDifficulty == SignalToGame.difficulty0 then if player.user.level &gt; monsterLevel then monsterLevel = player.user.level if monsterLevel &gt; 30 then monsterLevel = 30 end end\tend\t-- æ¯”è¼ƒ WeaponOption å’Œç­‰ç´šä¸¦é¡¯ç¤º UI é–å®šé¡¯ç¤ºï¼ˆå•†åº—æ«¥çª—ï¼‰\tfor i = 1, #BuymenuWeaponList do local option = Common.GetWeaponOption(BuymenuWeaponList[i]) if option then player:SetBuymenuLockedUI(BuymenuWeaponList[i], option.user.level &gt; player.user.level, option.user.level) end\tend\t-- æ¯”è¼ƒæ­¦å™¨å’Œç­‰ç´šä¸¦é¡¯ç¤º UI é–å®šé¡¯ç¤ºï¼ˆæ­¦å™¨åº«å­˜è¦–çª—ï¼‰\tlocal invenWeapons = player:GetWeaponInvenList()\tfor i = 1, #invenWeapons do player:SetWeaponInvenLockedUI(invenWeapons[i], invenWeapons[i].user.level &gt; player.user.level, invenWeapons[i].user.level)\tendend-- æ ¹æ“šç©å®¶ç›®å‰ç­‰ç´šå’Œç¶“é©—å€¼è¨ˆç®—ç¶“é©—ç™¾åˆ†æ¯”function CalcExpRate(level, exp)\treturn exp / PlayerRequireExp[level]end-- çµ¦äºˆç©å®¶ç¶“é©—å€¼function AddExp(player, exp)\tlocal pu = player.user\t-- å¦‚æœæ‚¨å·²é”åˆ°æ»¿ç´šï¼Œè«‹è·³é\tif pu.level &gt;= LEVEL_MAX then return\tend\tpu.exp = pu.exp + exp -- å‡ç´š\tif pu.exp &gt; PlayerRequireExp[pu.level] then pu.level = pu.level + 1 if pu.level &gt;= LEVEL_MAX then pu.exp = 0 else pu.exp = pu.exp - PlayerRequireExp[pu.level - 1] end OnLevelUp(player)\tend\t-- é¡¯ç¤ºå’Œæ›´æ–°ç­‰ç´š/ç¶“é©— UI\tpu.expRate = CalcExpRate(pu.level, pu.exp)\tplayer:SetLevelUI(pu.level, pu.expRate)end--[[ å·¥ä½œå®¤å‘¼å«åŠŸèƒ½ï¼ˆæ­¦å™¨ã€æ€ªç‰©ç›¸é—œï¼‰ ]]-- å­—ä¸²åˆ†å‰²å‡½æ•¸function splitstr_tonumber(inputstr)\tlocal t = &#123;&#125;\tfor str in string.gmatch(inputstr, &quot;([^,]*)&quot;) do table.insert(t, tonumber(str))\tend\treturn tend-- æŒ‡å®šæ¯å€‹æ€ªç‰©çµ„çš„ AttackTo ä½ç½®MonsterAttackPos = &#123;\t-- CreateDefaultMonsters\t[1] = &#123;x = -12, y = 100, z = 1&#125;,\t[2] = &#123;x = -9, y = 98, z = 1&#125;,\t[3] = &#123;x = 14, y = 77, z = 1&#125;,\t[7] = &#123;x = 80, y = 26, z = 1&#125;,\t[9] = &#123;x = 81, y = 22, z = 1&#125;,\t[11] = &#123;x = 81, y = 24, z = 1&#125;,\t[13] = &#123;x = 36, y = -14, z = 1&#125;,\t[14] = &#123;x = 35, y = -11, z = 1&#125;,\t[17] = &#123;x = 34, y = -32, z = -3&#125;,\t[18] = &#123;x = 35, y = -40, z = -3&#125;,\t[8055] = &#123;x = 25, y = -31, z = -3&#125;,\t-- CreateWaveMonsters\t[1000] = &#123;x = -4, y = 72, z = 1&#125;,\t-- CreateSpecialMonsters\t[10000] = &#123;x = -12, y = 108, z = 1&#125;,&#125;-- æ€ªç‰©ç­‰ç´šçš„ç¢ºå®šfunction GetRandomGrade(min, max)\tif min == max then return min\tend\tlocal grade = min\tlocal weightMax = 0.0\tfor i = min, max do weightMax = weightMax + MonsterGradeProb[i]\tend\tlocal weight = Game.RandomFloat(0.0, weightMax)\tlocal weightSum = 0.0\tfor i = min, max do weightSum = weightSum + MonsterGradeProb[i] if weight &lt;= weightSum then return i end\tend\treturn minendfunction CreateDefaultMonsters(callerOn, arg)\tif callerOn == nil or callerOn == false then return\tend\tlocal args = splitstr_tonumber(arg) -- æ‹†åˆ† arg å­—ä¸²ä¸¦å°‡å…¶å„²å­˜åœ¨æ•¸å­—æ•¸çµ„ä¸­ã€‚\tlocal type = MonsterTypes[args[1]] -- æ€ªç‰©é¡å‹\tlocal num = args[2] -- å¬å–šæ€ªç‰©æ•¸é‡\tlocal groupid = args[3] -- æ€ªç‰©ç¾¤çµ„ID\tlocal grade = GetRandomGrade(args[4], args[5]) -- æ€ªç‰©ç­‰ç´š\t-- Game.GetScriptCaller()ï¼šå–å¾—å‘¼å«å‡½æ•¸çš„è…³æœ¬å‡½æ•¸å‘¼å«VoxelEntityã€‚\tlocal monsters = CreateMonsters(type, num, Game.GetScriptCaller().position, groupid, grade)\t-- AttackTo éœ€è¦æŒ‡å®šåœ°é»çš„æ€ªç‰©ç¾¤\tfor i = 1, #monsters do if MonsterAttackPos[groupid] then monsters[i]:AttackTo(MonsterAttackPos[groupid]) -- ç§»å‹•åˆ°æŒ‡å®šåº§æ¨™æ™‚é€²è¡Œæ”»æ“Š end\tendend-- æ€ªç‰©waveæˆåŠŸèƒ½function CreateWaveMonsters(callerOn, arg)\tif callerOn == nil or callerOn == false then return\tend\tlocal args = splitstr_tonumber(arg)\tlocal type = MonsterTypes[args[1]]\tlocal num = args[2]\tlocal groupid = args[3]\tlocal grade = GetRandomGrade(args[4], args[5])\tlocal waveCnt = args[6] -- ç”¢ç”Ÿçš„waveæ•¸\tif monsterWaveCnt[groupid] then monsterWaveCnt[groupid] = monsterWaveCnt[groupid] + 1 if monsterWaveCnt[groupid] &gt; waveCnt then if monsterWaveCnt[groupid] == waveCnt + 1 then Game.SetTrigger(&#x27;OnWaveEnded&#x27; .. groupid, true) end return end\telse monsterWaveCnt[groupid] = 1\tend\tif Game.GetScriptCaller() then monsterWavePosition[groupid] = Game.GetScriptCaller().position\tend\tlocal monsters = CreateMonsters(type, num, monsterWavePosition[groupid], groupid, grade)\tfor i = 1, #monsters do monsters[i].user.waveFunc = CreateWaveMonsters monsters[i].user.waveFuncArg = arg if MonsterAttackPos[groupid] then monsters[i]:AttackTo(MonsterAttackPos[groupid]) -- ç§»å‹•åˆ°æŒ‡å®šåº§æ¨™æ™‚é€²è¡Œæ”»æ“Š end\tendend-- ç‰¹å®šç‰©å“æ‰è½æ€ªç‰©å‰µå»ºåŠŸèƒ½function CreateSpecialMonsters(callerOn, arg)\tif callerOn then local args = splitstr_tonumber(arg) local type = MonsterTypes[args[1]] local num = args[2] local groupid = args[3] local grade = GetRandomGrade(args[4], args[5]) local monsters = CreateMonsters(type, num, Game.GetScriptCaller().position, groupid, grade) for i = 1, #monsters do monsters[i].user.specialWeaponDrop = groupid -- æŒ‡å®šç‰¹å®šç‰©å“æ‰è½ if MonsterAttackPos[groupid] then monsters[i]:AttackTo(MonsterAttackPos[groupid]) -- ç§»å‹•åˆ°æŒ‡å®šåº§æ¨™æ™‚é€²è¡Œæ”»æ“Š end end\tendend-- ç‰¹å®šç‰©å“æ‰è½æŒ‡å®šåŠŸèƒ½function CreateSpecialWeapon(specialWeaponDrop, position)\tif specialWeaponDrop == 10000 then local weapon = Game.Weapon.CreateAndDrop(Common.WEAPON.P90, position) SetWeaponAttributeDefault(weapon)\telseif specialWeaponDrop == 10001 then local weapon = Game.Weapon.CreateAndDrop(Common.WEAPON.M134Minigun, position) SetWeaponAttributeDefault(weapon)\tendend-- å‰µå»ºæ”¾ç½®åœ¨åœ°åœ–ä¸Šçš„åŸºæœ¬æ­¦å™¨function CreateDefaultWeapon() local weapon = Game.Weapon.CreateAndDrop(Common.WEAPON.USP45, &#123;x = -6, y = 150, z = 1&#125;)\tSetWeaponAttributeDefault(weapon)end-- éš¨æ©Ÿæ­¦å™¨ç”Ÿæˆfunction CreateRandomWeapon(callerOn, arg)\tif callerOn then CreateWeapon(tonumber(arg), Game.GetScriptCaller().position)\tendend--[[ äº‹ä»¶å‡½æ•¸ ]]-- ç•¶ç©å®¶åœ¨é¸æ“‡è·æ¥­å¾Œé¦–æ¬¡ç”Ÿæˆæ™‚èª¿ç”¨çš„å‡½æ•¸function Game.Rule:OnPlayerJoiningSpawn(player)\t-- å„²å­˜åˆ°ç©å®¶æ•¸çµ„\tplayers[player.index] = player\t-- å°‡ç›¸æ©Ÿæ”¹ç‚ºç¬¬ä¸‰äººç¨±ï¼Œå°‡è¼¸å…¥æ³•æ”¹ç‚ºåŸºæ–¼æ»‘é¼ æŒ‡æ¨™\tplayer:SetThirdPersonFixedView(-45, 53, 100, 250) -- yaw, pitch, minDist, maxDist\t-- ThirdPersonFixedView ä¿®æ”¹æ»‘é¼ æŒ‡æ¨™å…‰ç·šæŠ•å°„ä½ç½®çš„è¨ˆç®—æ–¹å¼\tplayer:SetThirdPersonFixedPlane(Game.THIRDPERSON_FIXED_PLANE.GROUND)\t-- åŸºç¤æ°´æº–ã€ç¶“é©—\tplayer.user.level = 1\tplayer.user.exp = 0\tplayer.user.expRate = 0\t-- UIæŒ‰ç´šåˆ¥åˆå§‹åŒ–\tOnLevelUp(player) -- æ­¦å™¨é–UIåˆå§‹åŒ–ç›®çš„\tplayer:SetLevelUI(player.user.level, player.user.expRate) -- ç­‰ç´š/ç¶“é©— UI è¨­å®š\t-- åœ˜éšŠè¨­å®š\tplayer.team = Game.TEAM.CTend-- entity ç•¶ï¼ˆæ€ªç‰©ã€ç©å®¶ç­‰ï¼‰å—åˆ°å‚·å®³æ™‚å‘¼å«çš„å‡½æ•¸ã€‚function Game.Rule:OnTakeDamage(victim, attacker, damage, weapontype, hitbox)\tif attacker == nil or victim == nil then return end\tif victim:IsMonster() then victim = victim:ToMonster() victim:ShowOverheadDamage(damage, 0) -- å‚·å®³é¡¯ç¤ºåœ¨é ­é ‚ä¸Šæ–¹ã€‚ å¦‚æœç¬¬äºŒå€‹åƒæ•¸ï¼ˆç©å®¶ç´¢å¼•ï¼‰ç‚º 0ï¼Œå‰‡æœƒé¡¯ç¤ºçµ¦æ‰€æœ‰äººã€‚\tendend-- entityæ­»äº¡æ™‚å‘¼å«çš„å‡½æ•¸function Game.Rule:OnKilled(victim, killer)\tif victim == nil or killer == nil then return\tend\t-- ç•¶ç©å®¶æ­»äº¡æ™‚ä½¿ä»–å¾©æ´»\tif victim:IsPlayer() then victim = victim:ToPlayer() -- å¦‚æœé›£åº¦ä¸æ­£å¸¸ï¼Œç¶“é©—å€¼æ¸›å°‘10%ã€‚ if mapDifficulty ~= SignalToGame.difficulty0 then AddExp(victim, -math.floor(PlayerRequireExp[victim.user.level] / 10.0)) end if victim.user.spawnable == true then victim:Respawn() end -- éš±è—é‡æ–°è¼‰å…¥ UI victim:Signal(SignalToUI.reloadFinished)\tend\t-- ç•¶æ€ªç‰©æ­»äº¡æ™‚\tif victim:IsMonster() then victim = victim:ToMonster() -- å¦‚æœkilleræ˜¯ç©å®¶ï¼Œå‰‡æœƒçµ¦äºˆç¶“é©—å€¼ã€‚ if killer:IsPlayer() then killer = killer:ToPlayer() AddExp(killer, victim.user.exp) end -- ç‚ºæ€ªç‰©è£½ä½œæŒ‡å®šæ­¦å™¨æˆ–æ ¹æ“šæ€ªç‰©ç­‰ç´šæª¢æŸ¥æ­¦å™¨æ‰è½æ©Ÿç‡ä¾†æ‰è½æ­¦å™¨ã€‚ if victim.user.specialWeaponDrop then CreateSpecialWeapon(victim.user.specialWeaponDrop, victim.position) else weight = Game.RandomFloat(0.0, 1.0) if weight &lt;= WeaponDropProb[victim.user.grade] then CreateWeapon(GetWeaponRandomLevel(victim.user.level), victim.position) end end -- æª¢æŸ¥æ€ªç‰©æ•¸é‡ï¼Œå¦‚æœé”åˆ° 0ï¼Œå‰‡åœ¨ OnMonsterKilled å‡½æ•¸ä¸­å‚³é€åˆ°å·¥ä½œå®¤ã€‚ monsterGroupCnt[victim.user.groupid] = monsterGroupCnt[victim.user.groupid] - 1 if monsterGroupCnt[victim.user.groupid] &lt;= 0 then monsterGroupCnt[victim.user.groupid] = nil OnMonsterKilled(victim) end\tendend-- åµæ¸¬æ­¦å™¨æ˜¯å¦å¯ä»¥è³¼è²·çš„åŠŸèƒ½-- æœªåŒ…å«åœ¨è…³æœ¬æ­¦å™¨æ¸…å–®ä¸­çš„æ­¦å™¨ä¸æœƒè¢«å‘¼å«ã€‚function Game.Rule:CanBuyWeapon(player, weaponid)\tlocal weaponOption = Common.GetWeaponOption(weaponid)\treturn weaponOption.user.level &lt;= player.user.levelend-- åµæ¸¬æ­¦å™¨æ˜¯å¦å¯ä»¥æ‰‹æŒçš„åŠŸèƒ½-- æœªåŒ…å«åœ¨è…³æœ¬æ­¦å™¨æ¸…å–®ä¸­çš„æ­¦å™¨ä¸æœƒè¢«å‘¼å«ã€‚-- å¦‚æœå¾æœªä½¿ç”¨é Weapon é¡ï¼Œå‰‡ Weapon åƒæ•¸å°‡ä½œç‚º nil å‚³éã€‚function Game.Rule:CanHaveWeaponInHand(player, weaponid, weapon)\tlocal weaponOptionCheck = Common.GetWeaponOption(weaponid).user.level &lt;= player.user.level\tlocal weaponCheck = weapon == nil or weapon.user.level == nil or weapon.user.level &lt;= player.user.level\treturn weaponOptionCheck and weaponCheckend-- å–å¾—æ­¦å™¨æ™‚å‘¼å«çš„å‡½æ•¸-- æœªåŒ…å«åœ¨è…³æœ¬æ­¦å™¨æ¸…å–®ä¸­çš„æ­¦å™¨ä¸æœƒè¢«å‘¼å«ã€‚-- å¦‚æœå¾æœªä½¿ç”¨é Weapon é¡ï¼Œå‰‡ Weapon åƒæ•¸å°‡ä½œç‚º nil å‚³éã€‚function Game.Rule:OnGetWeapon(player, weaponid, weapon)\tif weapon == nil then return\tend\t-- åŸºæœ¬èƒ½åŠ›è¨­å®š\tif weapon.user.level == nil then SetWeaponAttributeDefault(weapon)\tend\t-- é–å®šçš„ä½¿ç”¨è€…ä»‹é¢æ›´æ–°\tplayer:SetWeaponInvenLockedUI(weapon, weapon.user.level &gt; player.user.level, weapon.user.level)end-- ç”¨æ–¼å‚³é€é‡è£æ™‚é–“çš„è®Šæ•¸reloadTimeSync = Game.SyncValue.Create(&quot;reloadTime&quot;)-- é‡æ–°è¼‰å…¥æ™‚å‘¼å«çš„å‡½æ•¸-- å¦‚æœ Weapon é¡åˆ¥å¾æœªä½¿ç”¨éæˆ–ä¸æ˜¯è…³æœ¬æ­¦å™¨ï¼Œå‰‡ Weapon åƒæ•¸å°‡ä½œç‚º nil å‚³éã€‚function Game.Rule:OnReload(player, weapon, time)\t-- é¡¯ç¤ºé‡æ–°è¼‰å…¥ UI\tplayer:Signal(SignalToUI.reloadStarted)\t-- äº¤ä»˜é‡è£æ™‚é–“\treloadTimeSync.value = timeend-- è¼‰å…¥å¾Œå‘¼å«çš„å‡½æ•¸-- å¦‚æœ Weapon é¡åˆ¥å¾æœªä½¿ç”¨éæˆ–ä¸æ˜¯è…³æœ¬æ­¦å™¨ï¼Œå‰‡ Weapon åƒæ•¸å°‡ä½œç‚º nil å‚³éã€‚function Game.Rule:OnReloadFinished(player, weapon)\tplayer:Signal(SignalToUI.reloadFinished) -- éš±è—é‡æ–°è¼‰å…¥ UIend-- ç•¶ç©å®¶åˆ‡æ›æ­¦å™¨æ™‚å‘¼å«çš„å‡½æ•¸function Game.Rule:OnSwitchWeapon(player)\tplayer:Signal(SignalToUI.reloadFinished) -- éš±è—é‡æ–°è¼‰å…¥ UIend-- å•Ÿå‹•å¾Œå‘¼å«çš„å‡½æ•¸-- å¦‚æœ Weapon é¡åˆ¥å¾æœªä½¿ç”¨éæˆ–ä¸æ˜¯è…³æœ¬æ­¦å™¨ï¼Œå‰‡ Weapon åƒæ•¸å°‡ä½œç‚º nil å‚³éã€‚function Game.Rule:PostFireWeapon(player, weapon, time)\t-- åƒ…ç•¶æ­¦å™¨çš„å°„æ“Šé–“éš”è¶…é 1 ç§’æ™‚æ‰æœƒé¡¯ç¤ºè£å½ˆ UIã€‚\tif time &gt; 1.0 then -- é¡¯ç¤ºé‡æ–°è¼‰å…¥ UI player:Signal(SignalToUI.reloadStarted) -- äº¤ä»˜é‡è£æ™‚é–“ reloadTimeSync.value = time\tendend-- ç•¶ç©å®¶æ‹”å‡ºæ­¦å™¨æ™‚å‘¼å«çš„å‡½æ•¸function Game.Rule:OnDeployWeapon(player, weapon)\tplayer:Signal(SignalToUI.reloadFinished) -- éš±è—é‡æ–°è¼‰å…¥ UIend-- ä¿å­˜æ¯å€‹ç©å®¶çš„ä¿å­˜è¨Šæ¯function Game.Rule:OnGameSave(player)\tif player == nil then return\tend\t-- ä¿å­˜ç­‰ç´šå’Œç¶“é©—å€¼\tplayer:SetGameSave(&#x27;level&#x27;, player.user.level)\tplayer:SetGameSave(&#x27;exp&#x27;, player.user.exp)\t-- ä¿å­˜æ‚¨ç›®å‰æŒæœ‰çš„æ­¦å™¨çš„ç­‰ç´š\tlocal primaryWeapon = player:GetPrimaryWeapon()\tlocal secondaryWeapon = player:GetSecondaryWeapon()\tif primaryWeapon then player:SetGameSave(&#x27;wpn_lv_pri&#x27;, primaryWeapon.user.level)\telse player:SetGameSave(&#x27;wpn_lv_pri&#x27;, 0)\tend\tif secondaryWeapon then player:SetGameSave(&#x27;wpn_lv_sec&#x27;, secondaryWeapon.user.level)\telse player:SetGameSave(&#x27;wpn_lv_sec&#x27;, 0)\tend\t-- ä¿å­˜åº«å­˜æ­¦å™¨ç­‰ç´š\tlocal invenWeapons = player:GetWeaponInvenList()\tfor i = 1, #invenWeapons do player:SetGameSave(&#x27;wpn_lv_inven&#x27; .. i, invenWeapons[i].user.level)\tendendfunction DoubleToInt(number)\treturn math.floor(math.abs(number + EPSILON))end-- è¼‰å…¥æ¯å€‹ç©å®¶çš„ä¿å­˜è¨Šæ¯function Game.Rule:OnLoadGameSave(player)\tif player == nil then return\tend\t-- ç­‰ç´šã€ç¶“é©—è² è·\tplayer.user.level = DoubleToInt(player:GetGameSave(&#x27;level&#x27;))\tplayer.user.exp = DoubleToInt(player:GetGameSave(&#x27;exp&#x27;))\tif player.user.level == nil then player.user.level = 1\tend\tif player.user.exp == nil then player.user.exp = 0\tend\tplayer.user.expRate = CalcExpRate(player.user.level, player.user.exp)\t-- è¼‰å…¥ä½ ç›®å‰æŒæœ‰çš„æ­¦å™¨\tlocal primaryWeapon = player:GetPrimaryWeapon()\tlocal secondaryWeapon = player:GetSecondaryWeapon()\tif primaryWeapon then primaryWeapon.user.level = DoubleToInt(player:GetGameSave(&#x27;wpn_lv_pri&#x27;))\tend\tif secondaryWeapon then secondaryWeapon.user.level = DoubleToInt(player:GetGameSave(&#x27;wpn_lv_sec&#x27;))\tend\t-- è¼‰å…¥åº«å­˜æ­¦å™¨ç­‰ç´š\tlocal invenWeapons = player:GetWeaponInvenList()\tfor i = 1, #invenWeapons do invenWeapons[i].user.level = DoubleToInt(player:GetGameSave(&#x27;wpn_lv_inven&#x27; .. i))\tend\t-- UIæŒ‰ç´šåˆ¥åˆå§‹åŒ–\tOnLevelUp(player) -- æ­¦å™¨é–UIåˆå§‹åŒ–ç›®çš„\tplayer:SetLevelUI(player.user.level, player.user.expRate) -- ç­‰ç´š/ç¶“é©— UI è¨­å®šend-- é‡ç½®æ¯å€‹ç©å®¶çš„ä¿å­˜è¨Šæ¯function Game.Rule:OnClearGameSave(player)\tplayer.user.level = 1\tplayer.user.exp = 0\tplayer.user.expRate = 0\tplayer:RemoveWeapon()\tplayer:ClearWeaponInven()\t-- UIæŒ‰ç´šåˆ¥åˆå§‹åŒ–\tOnLevelUp(player) -- æ­¦å™¨é–UIåˆå§‹åŒ–ç›®çš„\tplayer:SetLevelUI(player.user.level, player.user.expRate) -- ç­‰ç´š/ç¶“é©— UI è¨­å®šend--[[ é€éUIå‚³è¼¸è¨Šæ¯ ]]function Game.Rule:OnPlayerSignal(player, signal)\tif signal == SignalToGame.openWeaponInven then player:ToggleWeaponInven()\tendend-- æ‰“é–‹å•†åº—ï¼ˆå‘¼å«Studioçš„å‡½æ•¸ï¼‰function ShowBuymenu(callerOn)\tlocal triggerEnt = Game.GetTriggerEntity()\tif triggerEnt and triggerEnt:IsPlayer() then triggerEnt = triggerEnt:ToPlayer() triggerEnt:ShowBuymenu()\tendend"}]